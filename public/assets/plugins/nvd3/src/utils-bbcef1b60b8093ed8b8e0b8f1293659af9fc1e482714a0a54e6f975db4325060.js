nv.utils.windowSize=function(){var t={width:640,height:480};return window.innerWidth&&window.innerHeight?(t.width=window.innerWidth,t.height=window.innerHeight,t):"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth?(t.width=document.documentElement.offsetWidth,t.height=document.documentElement.offsetHeight,t):document.body&&document.body.offsetWidth?(t.width=document.body.offsetWidth,t.height=document.body.offsetHeight,t):t},nv.utils.windowResize=function(t){return window.addEventListener?window.addEventListener("resize",t):nv.log("ERROR: Failed to bind to window.resize with: ",t),{callback:t,clear:function(){window.removeEventListener("resize",t)}}},nv.utils.getColor=function(t){if(void 0===t)return nv.utils.defaultColor();if(Array.isArray(t)){var n=d3.scale.ordinal().range(t);return function(t,e){var i=void 0===e?t:e;return t.color||n(i)}}return t},nv.utils.defaultColor=function(){return nv.utils.getColor(d3.scale.category20().range())},nv.utils.customTheme=function(t,n,e){n=n||function(t){return t.key},e=e||d3.scale.category20().range();var i=e.length;return function(r){var o=n(r);return"function"==typeof t[o]?t[o]():void 0!==t[o]?t[o]:(i||(i=e.length),i-=1,e[i])}},nv.utils.pjax=function(t,n){var e=function(e){d3.html(e,function(e){var i=d3.select(n).node();i.parentNode.replaceChild(d3.select(e).select(n).node(),i),nv.utils.pjax(t,n)})};d3.selectAll(t).on("click",function(){history.pushState(this.href,this.textContent,this.href),e(this.href),d3.event.preventDefault()}),d3.select(window).on("popstate",function(){d3.event.state&&e(d3.event.state)})},nv.utils.calcApproxTextWidth=function(t){if("function"==typeof t.style&&"function"==typeof t.text){var n=parseInt(t.style("font-size").replace("px",""),10),e=t.text().length;return e*n*.5}return 0},nv.utils.NaNtoZero=function(t){return"number"!=typeof t||isNaN(t)||null===t||t===1/0||t===-(1/0)?0:t},d3.selection.prototype.watchTransition=function(t){var n=[this].concat([].slice.call(arguments,1));return t.transition.apply(t,n)},nv.utils.renderWatch=function(t,n){if(!(this instanceof nv.utils.renderWatch))return new nv.utils.renderWatch(t,n);var e=void 0!==n?n:250,i=[],r=this;this.models=function(t){return t=[].slice.call(arguments,0),t.forEach(function(t){t.__rendered=!1,function(t){t.dispatch.on("renderEnd",function(){t.__rendered=!0,r.renderEnd("model")})}(t),i.indexOf(t)<0&&i.push(t)}),this},this.reset=function(t){void 0!==t&&(e=t),i=[]},this.transition=function(t,n,o){if(n=arguments.length>1?[].slice.call(arguments,1):[],o=n.length>1?n.pop():void 0!==e?e:250,t.__rendered=!1,i.indexOf(t)<0&&i.push(t),0===o)return t.__rendered=!0,t.delay=function(){return this},t.duration=function(){return this},t;0===t.length?t.__rendered=!0:t.every(function(t){return!t.length})?t.__rendered=!0:t.__rendered=!1;var s=0;return t.transition().duration(o).each(function(){++s}).each("end",function(){0===--s&&(t.__rendered=!0,r.renderEnd.apply(this,n))})},this.renderEnd=function(){i.every(function(t){return t.__rendered})&&(i.forEach(function(t){t.__rendered=!1}),t.renderEnd.apply(this,arguments))}},nv.utils.deepExtend=function(t){var n=arguments.length>1?[].slice.call(arguments,1):[];n.forEach(function(n){for(var e in n){var i=t[e]instanceof Array,r="object"==typeof t[e],o="object"==typeof n[e];r&&!i&&o?nv.utils.deepExtend(t[e],n[e]):t[e]=n[e]}})},nv.utils.state=function(){if(!(this instanceof nv.utils.state))return new nv.utils.state;var t={},n=function(){},e=function(){return{}},i=null,r=null;this.dispatch=d3.dispatch("change","set"),this.dispatch.on("set",function(t){n(t,!0)}),this.getter=function(t){return e=t,this},this.setter=function(t,e){return e||(e=function(){}),n=function(n,i){t(n),i&&e()},this},this.init=function(t){i=i||{},nv.utils.deepExtend(i,t)};var o=function(){var n=e();if(JSON.stringify(n)===JSON.stringify(t))return!1;for(var i in n)void 0===t[i]&&(t[i]={}),t[i]=n[i],r=!0;return!0};this.update=function(){i&&(n(i,!1),i=null),o.call(this)&&this.dispatch.change(t)}},nv.utils.optionsFunc=function(t){return t&&d3.map(t).forEach(function(t,n){"function"==typeof this[t]&&this[t](n)}.bind(this)),this},nv.utils.calcTicksX=function(t,n){var e=1,i=0;for(i;i<n.length;i+=1){var r=n[i]&&n[i].values?n[i].values.length:0;e=r>e?r:e}return nv.log("Requested number of ticks: ",t),nv.log("Calculated max values to be: ",e),t=t>e?t=e-1:t,t=1>t?1:t,t=Math.floor(t),nv.log("Calculating tick count as: ",t),t},nv.utils.calcTicksY=function(t,n){return nv.utils.calcTicksX(t,n)},nv.utils.initOption=function(t,n){t._calls&&t._calls[n]?t[n]=t._calls[n]:(t[n]=function(e){return arguments.length?(t._overrides[n]=!0,t._options[n]=e,t):t._options[n]},t["_"+n]=function(e){return arguments.length?(t._overrides[n]||(t._options[n]=e),t):t._options[n]})},nv.utils.initOptions=function(t){t._overrides=t._overrides||{};var n=Object.getOwnPropertyNames(t._options||{}),e=Object.getOwnPropertyNames(t._calls||{});n=n.concat(e);for(var i in n)nv.utils.initOption(t,n[i])},nv.utils.inheritOptionsD3=function(t,n,e){t._d3options=e.concat(t._d3options||[]),e.unshift(n),e.unshift(t),d3.rebind.apply(this,e)},nv.utils.arrayUnique=function(t){return t.sort().filter(function(n,e){return!e||n!=t[e-1]})},nv.utils.symbolMap=d3.map(),nv.utils.symbol=function(){function t(t,i){var r=n.call(this,t,i),o=e.call(this,t,i);return-1!==d3.svg.symbolTypes.indexOf(r)?d3.svg.symbol().type(r).size(o)():nv.utils.symbolMap.get(r)(o)}var n,e=64;return t.type=function(e){return arguments.length?(n=d3.functor(e),t):n},t.size=function(n){return arguments.length?(e=d3.functor(n),t):e},t},nv.utils.inheritOptions=function(t,n){var e=Object.getOwnPropertyNames(n._options||{}),i=Object.getOwnPropertyNames(n._calls||{}),r=n._inherited||[],o=n._d3options||[],s=e.concat(i).concat(r).concat(o);s.unshift(n),s.unshift(t),d3.rebind.apply(this,s),t._inherited=nv.utils.arrayUnique(e.concat(i).concat(r).concat(e).concat(t._inherited||[])),t._d3options=nv.utils.arrayUnique(o.concat(t._d3options||[]))},nv.utils.initSVG=function(t){t.classed({"nvd3-svg":!0})},nv.utils.sanitizeHeight=function(t,n){return t||parseInt(n.style("height"),10)||400},nv.utils.sanitizeWidth=function(t,n){return t||parseInt(n.style("width"),10)||960},nv.utils.availableHeight=function(t,n,e){return nv.utils.sanitizeHeight(t,n)-e.top-e.bottom},nv.utils.availableWidth=function(t,n,e){return nv.utils.sanitizeWidth(t,n)-e.left-e.right},nv.utils.noData=function(t,n){var e=t.options(),i=e.margin(),r=e.noData(),o=null==r?["No Data Available."]:[r],s=nv.utils.availableHeight(null,n,i),u=nv.utils.availableWidth(null,n,i),a=i.left+u/2,l=i.top+s/2;n.selectAll("g").remove();var c=n.selectAll(".nv-noData").data(o);c.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),c.attr("x",a).attr("y",l).text(function(t){return t})},nv.utils.wrapTicks=function(t,n){t.each(function(){for(var t,e=d3.select(this),i=e.text().split(/\s+/).reverse(),r=[],o=0,s=1.1,u=e.attr("y"),a=parseFloat(e.attr("dy")),l=e.text(null).append("tspan").attr("x",0).attr("y",u).attr("dy",a+"em");t=i.pop();)r.push(t),l.text(r.join(" ")),l.node().getComputedTextLength()>n&&(r.pop(),l.text(r.join(" ")),r=[t],l=e.append("tspan").attr("x",0).attr("y",u).attr("dy",++o*s+a+"em").text(t))})},nv.utils.arrayEquals=function(t,n){if(t===n)return!0;if(!t||!n)return!1;if(t.length!=n.length)return!1;for(var e=0,i=t.length;i>e;e++)if(t[e]instanceof Array&&n[e]instanceof Array){if(!nv.arrayEquals(t[e],n[e]))return!1}else if(t[e]!=n[e])return!1;return!0};