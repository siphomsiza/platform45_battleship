nv.models.furiousLegend=function(){"use strict";function t(v){function b(t,e){return"furious"!=h?"#000":f?t.disengaged?s(t,e):"#fff":f?void 0:t.disabled?s(t,e):"#fff"}function p(t,e){return f&&"furious"==h?t.disengaged?"#fff":s(t,e):t.disabled?"#fff":s(t,e)}return v.each(function(t){var v=n-e.left-e.right,m=d3.select(this);nv.utils.initSVG(m);var x=m.selectAll("g.nv-legend").data([t]),k=(x.enter().append("g").attr("class","nvd3 nv-legend").append("g"),x.select("g"));x.attr("transform","translate("+e.left+","+e.top+")");var y,D=k.selectAll(".nv-series").data(function(t){return"furious"!=h?t:t.filter(function(t){return f?!0:!t.disengaged})}),L=D.enter().append("g").attr("class","nv-series");if("classic"==h)L.append("circle").style("stroke-width",2).attr("class","nv-legend-symbol").attr("r",5),y=D.select("circle");else if("furious"==h){L.append("rect").style("stroke-width",2).attr("class","nv-legend-symbol").attr("rx",3).attr("ry",3),y=D.select("rect"),L.append("g").attr("class","nv-check-box").property("innerHTML",'<path d="M0.5,5 L22.5,5 L22.5,26.5 L0.5,26.5 L0.5,5 Z" class="nv-box"></path><path d="M5.5,12.8618467 L11.9185089,19.2803556 L31,0.198864511" class="nv-check"></path>').attr("transform","translate(-10,-8)scale(0.5)");var C=D.select(".nv-check-box");C.each(function(t,e){d3.select(this).selectAll("path").attr("stroke",b(t,e))})}L.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dy",".32em").attr("dx","8");var M=D.select("text.nv-legend-text");D.on("mouseover",function(t,e){g.legendMouseover(t,e)}).on("mouseout",function(t,e){g.legendMouseout(t,e)}).on("click",function(t,e){g.legendClick(t,e);var n=D.data();if(d){if("classic"==h)c?(n.forEach(function(t){t.disabled=!0}),t.disabled=!1):(t.disabled=!t.disabled,n.every(function(t){return t.disabled})&&n.forEach(function(t){t.disabled=!1}));else if("furious"==h)if(f)t.disengaged=!t.disengaged,t.userDisabled=void 0==t.userDisabled?!!t.disabled:t.userDisabled,t.disabled=t.disengaged||t.userDisabled;else if(!f){t.disabled=!t.disabled,t.userDisabled=t.disabled;var r=n.filter(function(t){return!t.disengaged});r.every(function(t){return t.userDisabled})&&n.forEach(function(t){t.disabled=t.userDisabled=!1})}g.stateChange({disabled:n.map(function(t){return!!t.disabled}),disengaged:n.map(function(t){return!!t.disengaged})})}}).on("dblclick",function(t,e){if(("furious"!=h||!f)&&(g.legendDblclick(t,e),d)){var n=D.data();n.forEach(function(t){t.disabled=!0,"furious"==h&&(t.userDisabled=t.disabled)}),t.disabled=!1,"furious"==h&&(t.userDisabled=t.disabled),g.stateChange({disabled:n.map(function(t){return!!t.disabled})})}}),D.classed("nv-disabled",function(t){return t.userDisabled}),D.exit().remove(),M.attr("fill",b).text(i);var w;switch(h){case"furious":w=23;break;case"classic":w=20}if(o){var A=[];D.each(function(t){var e;if(i(t).length>a){var n=i(t).substring(0,a);e=d3.select(this).select("text").text(n+"..."),d3.select(this).append("svg:title").text(i(t))}else e=d3.select(this).select("text");var r;try{if(r=e.node().getComputedTextLength(),0>=r)throw Error()}catch(s){r=nv.utils.calcApproxTextWidth(e)}A.push(r+l)});for(var E=0,T=0,O=[];v>T&&E<A.length;)O[E]=A[E],T+=A[E++];for(0===E&&(E=1);T>v&&E>1;){O=[],E--;for(var S=0;S<A.length;S++)A[S]>(O[S%E]||0)&&(O[S%E]=A[S]);T=O.reduce(function(t,e){return t+e})}for(var j=[],B=0,F=0;E>B;B++)j[B]=F,F+=O[B];D.attr("transform",function(t,e){return"translate("+j[e%E]+","+(5+Math.floor(e/E)*w)+")"}),u?k.attr("transform","translate("+(n-e.right-T)+","+e.top+")"):k.attr("transform","translate(0,"+e.top+")"),r=e.top+e.bottom+Math.ceil(A.length/E)*w}else{var G,H=5,K=5,V=0;D.attr("transform",function(){var t=d3.select(this).select("text").node().getComputedTextLength()+l;return G=K,n<e.left+e.right+G+t&&(K=G=5,H+=w),K+=t,K>V&&(V=K),"translate("+G+","+H+")"}),k.attr("transform","translate("+(n-e.right-V)+","+e.top+")"),r=e.top+e.bottom+H+15}"furious"==h&&y.attr("width",function(t,e){return M[0][e].getComputedTextLength()+27}).attr("height",18).attr("y",-9).attr("x",-15),y.style("fill",p).style("stroke",function(t,e){return t.color||s(t,e)})}),t}var e={top:5,right:0,bottom:5,left:0},n=400,r=20,i=function(t){return t.key},s=nv.utils.getColor(),a=20,o=!0,l=28,u=!0,d=!0,c=!1,f=!1,g=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout","stateChange"),h="classic";return t.dispatch=g,t.options=nv.utils.optionsFunc.bind(t),t._options=Object.create({},{width:{get:function(){return n},set:function(t){n=t}},height:{get:function(){return r},set:function(t){r=t}},key:{get:function(){return i},set:function(t){i=t}},align:{get:function(){return o},set:function(t){o=t}},rightAlign:{get:function(){return u},set:function(t){u=t}},maxKeyLength:{get:function(){return a},set:function(t){a=t}},padding:{get:function(){return l},set:function(t){l=t}},updateState:{get:function(){return d},set:function(t){d=t}},radioButtonMode:{get:function(){return c},set:function(t){c=t}},expanded:{get:function(){return f},set:function(t){f=t}},vers:{get:function(){return h},set:function(t){h=t}},margin:{get:function(){return e},set:function(t){e.top=void 0!==t.top?t.top:e.top,e.right=void 0!==t.right?t.right:e.right,e.bottom=void 0!==t.bottom?t.bottom:e.bottom,e.left=void 0!==t.left?t.left:e.left}},color:{get:function(){return s},set:function(t){s=nv.utils.getColor(t)}}}),nv.utils.initOptions(t),t};