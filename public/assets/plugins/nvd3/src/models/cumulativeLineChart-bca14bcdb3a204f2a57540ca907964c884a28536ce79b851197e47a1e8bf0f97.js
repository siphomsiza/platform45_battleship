nv.models.cumulativeLineChart=function(){"use strict";function t(u){return I.reset(),I.models(a),h&&I.models(r),m&&I.models(o),u.each(function(u){function A(){d3.select(t.container).style("cursor","ew-resize")}function W(){E.x=d3.event.x,E.i=Math.round(F.invert(E.x)),H()}function I(){d3.select(t.container).style("cursor","auto"),w.index=E.i,Y.stateChange(w)}function H(){tt.data([E]);var e=t.duration();t.duration(0),t.update(),t.duration(e)}var V=d3.select(this);nv.utils.initSVG(V),V.classed("nv-chart-"+C,!0);var z=this,O=nv.utils.availableWidth(f,V,d),X=nv.utils.availableHeight(p,V,d);if(t.update=function(){0===L?V.call(t):V.transition().duration(L).call(t)},t.container=this,w.setter(G(u),t.update).getter(M(u)).update(),w.disabled=u.map(function(t){return!!t.disabled}),!S){var _;S={};for(_ in w)w[_]instanceof Array?S[_]=w[_].slice(0):S[_]=w[_]}var j=d3.behavior.drag().on("dragstart",A).on("drag",W).on("dragend",I);if(!(u&&u.length&&u.filter(function(t){return t.values.length}).length))return nv.utils.noData(t,V),t;if(V.selectAll(".nv-noData").remove(),n=a.xScale(),i=a.yScale(),k)a.yDomain(null);else{var P=u.filter(function(t){return!t.disabled}).map(function(t){var e=d3.extent(t.values,a.y());return e[0]<-.95&&(e[0]=-.95),[(e[0]-e[1])/(1+e[1]),(e[1]-e[0])/(1+e[0])]}),T=[d3.min(P,function(t){return t[0]}),d3.max(P,function(t){return t[1]})];a.yDomain(T)}F.domain([0,u[0].values.length-1]).range([0,O]).clamp(!0);var u=e(E.i,u),B=b?"none":"all",N=V.selectAll("g.nv-wrap.nv-cumulativeLine").data([u]),R=N.enter().append("g").attr("class","nvd3 nv-wrap nv-cumulativeLine").append("g"),q=N.select("g");if(R.append("g").attr("class","nv-interactive"),R.append("g").attr("class","nv-x nv-axis").style("pointer-events","none"),R.append("g").attr("class","nv-y nv-axis"),R.append("g").attr("class","nv-background"),R.append("g").attr("class","nv-linesWrap").style("pointer-events",B),R.append("g").attr("class","nv-avgLinesWrap").style("pointer-events","none"),R.append("g").attr("class","nv-legendWrap"),R.append("g").attr("class","nv-controlsWrap"),g&&(l.width(O),q.select(".nv-legendWrap").datum(u).call(l),d.top!=l.height()&&(d.top=l.height(),X=nv.utils.availableHeight(p,V,d)),q.select(".nv-legendWrap").attr("transform","translate(0,"+-d.top+")")),y){var J=[{key:"Re-scale y-axis",disabled:!k}];s.width(140).color(["#444","#444","#444"]).rightAlign(!1).margin({top:5,right:0,bottom:5,left:20}),q.select(".nv-controlsWrap").datum(J).attr("transform","translate(0,"+-d.top+")").call(s)}N.attr("transform","translate("+d.left+","+d.top+")"),x&&q.select(".nv-y.nv-axis").attr("transform","translate("+O+",0)");var K=u.filter(function(t){return t.tempDisabled});N.select(".tempDisabled").remove(),K.length&&N.append("text").attr("class","tempDisabled").attr("x",O/2).attr("y","-.71em").style("text-anchor","end").text(K.map(function(t){return t.key}).join(", ")+" values cannot be calculated for this time period."),b&&(c.width(O).height(X).margin({left:d.left,top:d.top}).svgContainer(V).xScale(n),N.select(".nv-interactive").call(c)),R.select(".nv-background").append("rect"),q.select(".nv-background rect").attr("width",O).attr("height",X),a.y(function(t){return t.display.y}).width(O).height(X).color(u.map(function(t,e){return t.color||v(t,e)}).filter(function(t,e){return!u[e].disabled&&!u[e].tempDisabled}));var Q=q.select(".nv-linesWrap").datum(u.filter(function(t){return!t.disabled&&!t.tempDisabled}));Q.call(a),u.forEach(function(t,e){t.seriesIndex=e});var U=u.filter(function(t){return!t.disabled&&!!D(t)}),Z=q.select(".nv-avgLinesWrap").selectAll("line").data(U,function(t){return t.key}),$=function(t){var e=i(D(t));return 0>e?0:e>X?X:e};Z.enter().append("line").style("stroke-width",2).style("stroke-dasharray","10,10").style("stroke",function(t){return a.color()(t,t.seriesIndex)}).attr("x1",0).attr("x2",O).attr("y1",$).attr("y2",$),Z.style("stroke-opacity",function(t){var e=i(D(t));return 0>e||e>X?0:1}).attr("x1",0).attr("x2",O).attr("y1",$).attr("y2",$),Z.exit().remove();var tt=Q.selectAll(".nv-indexLine").data([E]);tt.enter().append("rect").attr("class","nv-indexLine").attr("width",3).attr("x",-2).attr("fill","red").attr("fill-opacity",.5).style("pointer-events","all").call(j),tt.attr("transform",function(t){return"translate("+F(t.i)+",0)"}).attr("height",X),h&&(r.scale(n)._ticks(nv.utils.calcTicksX(O/70,u)).tickSize(-X,0),q.select(".nv-x.nv-axis").attr("transform","translate(0,"+i.range()[0]+")"),q.select(".nv-x.nv-axis").call(r)),m&&(o.scale(i)._ticks(nv.utils.calcTicksY(X/36,u)).tickSize(-O,0),q.select(".nv-y.nv-axis").call(o)),q.select(".nv-background rect").on("click",function(){E.x=d3.mouse(this)[0],E.i=Math.round(F.invert(E.x)),w.index=E.i,Y.stateChange(w),H()}),a.dispatch.on("elementClick",function(t){E.i=t.pointIndex,E.x=F(E.i),w.index=E.i,Y.stateChange(w),H()}),s.dispatch.on("legendClick",function(e){e.disabled=!e.disabled,k=!e.disabled,w.rescaleY=k,Y.stateChange(w),t.update()}),l.dispatch.on("stateChange",function(e){for(var n in e)w[n]=e[n];Y.stateChange(w),t.update()}),c.dispatch.on("elementMousemove",function(e){a.clearHighlights();var n,i,l,s=[];if(u.filter(function(t,e){return t.seriesIndex=e,!t.disabled}).forEach(function(r,o){i=nv.interactiveBisect(r.values,e.pointXValue,t.x()),a.highlightPoint(o,i,!0);var c=r.values[i];"undefined"!=typeof c&&("undefined"==typeof n&&(n=c),"undefined"==typeof l&&(l=t.xScale()(t.x()(c,i))),s.push({key:r.key,value:t.y()(c,i),color:v(r,r.seriesIndex)}))}),s.length>2){var d=t.yScale().invert(e.mouseY),f=Math.abs(t.yScale().domain()[0]-t.yScale().domain()[1]),p=.03*f,g=nv.nearestValueIndex(s.map(function(t){return t.value}),d,p);null!==g&&(s[g].highlight=!0)}var h=r.tickFormat()(t.x()(n,i),i);c.tooltip.chartContainer(z.parentNode).valueFormatter(function(t){return o.tickFormat()(t)}).data({value:h,series:s})(),c.renderGuideLine(l)}),c.dispatch.on("elementMouseout",function(){a.clearHighlights()}),Y.on("changeState",function(e){"undefined"!=typeof e.disabled&&(u.forEach(function(t,n){t.disabled=e.disabled[n]}),w.disabled=e.disabled),"undefined"!=typeof e.index&&(E.i=e.index,E.x=F(E.i),w.index=e.index,tt.data([E])),"undefined"!=typeof e.rescaleY&&(k=e.rescaleY),t.update()})}),I.renderEnd("cumulativeLineChart immediate"),t}function e(t,e){return H||(H=a.y()),e.map(function(e){if(!e.values)return e;var n=e.values[t];if(null==n)return e;var i=H(n,t);return-.95>i&&!W?(e.tempDisabled=!0,e):(e.tempDisabled=!1,e.values=e.values.map(function(t,e){return t.display={y:(H(t,e)-i)/(1+i)},t}),e)})}var n,i,a=nv.models.line(),r=nv.models.axis(),o=nv.models.axis(),l=nv.models.legend(),s=nv.models.legend(),c=nv.interactiveGuideline(),u=nv.models.tooltip(),d={top:30,right:30,bottom:50,left:60},v=nv.utils.defaultColor(),f=null,p=null,g=!0,h=!0,m=!0,x=!1,y=!0,b=!1,k=!0,C=a.id(),w=nv.utils.state(),S=null,A=null,D=function(t){return t.average},Y=d3.dispatch("stateChange","changeState","renderEnd"),L=250,W=!1;w.index=0,w.rescaleY=k,r.orient("bottom").tickPadding(7),o.orient(x?"right":"left"),u.valueFormatter(function(t,e){return o.tickFormat()(t,e)}).headerFormatter(function(t,e){return r.tickFormat()(t,e)}),s.updateState(!1);var F=d3.scale.linear(),E={i:0,x:0},I=nv.utils.renderWatch(Y,L),M=function(t){return function(){return{active:t.map(function(t){return!t.disabled}),index:E.i,rescaleY:k}}},G=function(t){return function(e){void 0!==e.index&&(E.i=e.index),void 0!==e.rescaleY&&(k=e.rescaleY),void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}};a.dispatch.on("elementMouseover.tooltip",function(e){var n={x:t.x()(e.point),y:t.y()(e.point),color:e.point.color};e.point=n,u.data(e).hidden(!1)}),a.dispatch.on("elementMouseout.tooltip",function(){u.hidden(!0)});var H=null;return t.dispatch=Y,t.lines=a,t.legend=l,t.controls=s,t.xAxis=r,t.yAxis=o,t.interactiveLayer=c,t.state=w,t.tooltip=u,t.options=nv.utils.optionsFunc.bind(t),t._options=Object.create({},{width:{get:function(){return f},set:function(t){f=t}},height:{get:function(){return p},set:function(t){p=t}},rescaleY:{get:function(){return k},set:function(t){k=t}},showControls:{get:function(){return y},set:function(t){y=t}},showLegend:{get:function(){return g},set:function(t){g=t}},average:{get:function(){return D},set:function(t){D=t}},defaultState:{get:function(){return S},set:function(t){S=t}},noData:{get:function(){return A},set:function(t){A=t}},showXAxis:{get:function(){return h},set:function(t){h=t}},showYAxis:{get:function(){return m},set:function(t){m=t}},noErrorCheck:{get:function(){return W},set:function(t){W=t}},margin:{get:function(){return d},set:function(t){d.top=void 0!==t.top?t.top:d.top,d.right=void 0!==t.right?t.right:d.right,d.bottom=void 0!==t.bottom?t.bottom:d.bottom,d.left=void 0!==t.left?t.left:d.left}},color:{get:function(){return v},set:function(t){v=nv.utils.getColor(t),l.color(v)}},useInteractiveGuideline:{get:function(){return b},set:function(e){b=e,e===!0&&(t.interactive(!1),t.useVoronoi(!1))}},rightAlignYAxis:{get:function(){return x},set:function(t){x=t,o.orient(t?"right":"left")}},duration:{get:function(){return L},set:function(t){L=t,a.duration(L),r.duration(L),o.duration(L),I.reset(L)}}}),nv.utils.inheritOptions(t,a),nv.utils.initOptions(t),t};