nv.models.parallelCoordinates=function(){"use strict";function t(e){return n.reset(),e.each(function(e){function t(i){return K(W.map(function(e){if(isNaN(i.values[e.key])||isNaN(parseFloat(i.values[e.key]))||h){var t=B[e.key].domain(),n=B[e.key].range(),a=t[0]-(t[1]-t[0])/9;if(I.indexOf(e.key)<0){var r=d3.scale.linear().domain([a,t[1]]).range([c-12,n[1]]);B[e.key].brush.y(r),I.push(e.key)}if(isNaN(i.values[e.key])||isNaN(parseFloat(i.values[e.key])))return[V(e.key),B[e.key](a)]}return g!==undefined&&(0<I.length||h?(g.style("display","inline"),k.style("display","inline")):(g.style("display","none"),k.style("display","none"))),[V(e.key),B[e.key](i.values[e.key])]}))}function o(){C=q.filter(function(e){return!B[e].brush.empty()}),_=C.map(function(e){return B[e].brush.extent()}),S=[],C.forEach(function(e,t){S[t]={dimension:e,extent:_[t],hasNaN:!1,hasOnlyNaN:!1}}),T=[],F.style("display",function(n){var e=C.every(function(e,t){return!(!isNaN(n.values[e])&&!isNaN(parseFloat(n.values[e]))||_[t][0]!=B[e].brush.y().domain()[0])||_[t][0]<=n.values[e]&&n.values[e]<=_[t][1]&&!isNaN(parseFloat(n.values[e]))});return e&&T.push(n),e?null:"none"}),Q.brush({filters:S,active:T})}function s(){var e=0<C.length;S.forEach(function(e){e.extent[0]===B[e.dimension].brush.y().domain()[0]&&0<I.length&&(e.hasNaN=!0),e.extent[1]<B[e.dimension].domain()[0]&&(e.hasOnlyNaN=!0)}),Q.brushEnd(T,e)}function n(e){z[e.key]=this.parentNode.__origin__=V(e.key),O.attr("visibility","hidden")}function a(e){z[e.key]=Math.min(l,Math.max(0,this.parentNode.__origin__+=d3.event.x)),F.attr("d",t),W.sort(function(e,t){return i(e.key)-i(t.key)}),W.forEach(function(e,t){return e.currentPosition=t}),V.domain(W.map(function(e){return e.key})),w.attr("transform",function(e){return"translate("+i(e.key)+")"})}function r(e){delete this.parentNode.__origin__,delete z[e.key],d3.select(this.parentNode).attr("transform","translate("+V(e.key)+")"),F.attr("d",t),O.attr("d",t).attr("visibility",null),Q.dimensionsOrder(W)}function i(e){var t=z[e];return null==t?V(e):t}var u=d3.select(this),l=nv.utils.availableWidth(D,u,A),c=nv.utils.availableHeight(P,u,A);if(nv.utils.initSVG(u),e[0].values===undefined){var d=[];e.forEach(function(t){var n={};Object.keys(t).forEach(function(e){"name"!==e&&(n[e]=t[e])}),d.push({key:t.name,values:n})}),e=d}var f=e.map(function(e){return e.values});0===T.length&&(T=e),q=j.sort(function(e,t){return e.currentPosition-t.currentPosition}).map(function(e){return e.key}),W=j.filter(function(e){return!e.disabled}),V.rangePoints([0,l],1).domain(W.map(function(e){return e.key}));var m={},h=!1;q.forEach(function(t){var e=d3.extent(f,function(e){return+e[t]}),n=e[0],a=e[1],r=!1;(isNaN(n)||isNaN(a))&&(r=!0,a=n=0),n===a&&(n-=1,a+=1);var i=S.filter(function(e){return e.dimension==t});0!==i.length&&(r?(n=B[t].domain()[0],a=B[t].domain()[1]):!i[0].hasNaN&&G?(n=n>i[0].extent[0]?i[0].extent[0]:n,a=a<i[0].extent[1]?i[0].extent[1]:a):i[0].hasNaN&&(a=a<i[0].extent[1]?i[0].extent[1]:a,m[t]=B[t].domain()[1],h=!0)),B[t]=d3.scale.linear().domain([n,a]).range([.9*(c-12),0]),I=[],B[t].brush=d3.svg.brush().y(B[t]).on("brush",o).on("brushend",s)});var v=u.selectAll("g.nv-wrap.nv-parallelCoordinates").data([e]),p=v.enter().append("g").attr("class","nvd3 nv-wrap nv-parallelCoordinates").append("g"),y=v.select("g");p.append("g").attr("class","nv-parallelCoordinates background"),p.append("g").attr("class","nv-parallelCoordinates foreground"),p.append("g").attr("class","nv-parallelCoordinates missingValuesline"),v.attr("transform","translate("+A.left+","+A.top+")"),K.interpolate("cardinal").tension(J),L.orient("left");var g,k,N=d3.behavior.drag().on("dragstart",n).on("drag",a).on("dragend",r),x=V.range()[1]-V.range()[0];if(!isNaN(x)){var b=[0+x/2,c-12,l-x/2,c-12];(g=v.select(".missingValuesline").selectAll("line").data([b])).enter().append("line"),g.exit().remove(),g.attr("x1",function(e){return e[0]}).attr("y1",function(e){return e[1]}).attr("x2",function(e){return e[2]}).attr("y2",function(e){return e[3]}),(k=v.select(".missingValuesline").selectAll("text").data(["undefined values"])).append("text").data(["undefined values"]),k.enter().append("text"),k.exit().remove(),k.attr("y",c).attr("x",l-92-x/2).text(function(e){return e})}(O=v.select(".background").selectAll("path").data(e)).enter().append("path"),O.exit().remove(),O.attr("d",t),(F=v.select(".foreground").selectAll("path").data(e)).enter().append("path"),F.exit().remove(),F.attr("d",t).style("stroke-width",function(e){return isNaN(e.stroke)&&(e.stroke=1),e.stroke}).attr("stroke",function(e,t){return e.color||H(e,t)}),F.on("mouseover",function(e,t){d3.select(this).classed("hover",!0).style("stroke-width",e.stroke+2+"px").style("stroke-opacity",1),Q.elementMouseover({label:e.name,color:e.color||H(e,t)})}),F.on("mouseout",function(e,t){d3.select(this).classed("hover",!1).style("stroke-width",e.stroke+"px").style("stroke-opacity",.7),Q.elementMouseout({label:e.name,index:t})}),F.on("mousemove",function(){Q.elementMousemove()}),F.on("click",function(e){Q.elementClick({id:e.id})});var E=(w=y.selectAll(".dimension").data(W)).enter().append("g").attr("class","nv-parallelCoordinates dimension");w.attr("transform",function(e){return"translate("+V(e.key)+",0)"}),E.append("g").attr("class","nv-axis"),E.append("text").attr("class","nv-label").style("cursor","move").attr("dy","-1em").attr("text-anchor","middle").on("mouseover",function(e){Q.elementMouseover({label:e.tooltip||e.key})}).on("mouseout",function(e){Q.elementMouseout({label:e.tooltip})}).on("mousemove",function(){Q.elementMousemove()}).call(N),E.append("g").attr("class","nv-brushBackground"),w.exit().remove(),w.select(".nv-label").text(function(e){return e.key}),w.select(".nv-axis").each(function(e){d3.select(this).call(L.scale(B[e.key]).tickFormat(d3.format(e.format)))}),S.forEach(function(e){var t=B[e.dimension].brush.y().domain();e.hasOnlyNaN&&(e.extent[1]=(B[e.dimension].domain()[1]-t[0])*(e.extent[1]-e.extent[0])/(m[e.dimension]-e.extent[0])+t[0]),e.hasNaN&&(e.extent[0]=t[0]),G&&B[e.dimension].brush.extent(e.extent)});var C=q.filter(function(e){return!B[e].brush.empty()}),_=C.map(function(e){return B[e].brush.extent()}),M=T.slice(0);T=[],F.style("display",function(n){var e=C.every(function(e,t){return!(!isNaN(n.values[e])&&!isNaN(parseFloat(n.values[e]))||_[t][0]!=B[e].brush.y().domain()[0])||_[t][0]<=n.values[e]&&n.values[e]<=_[t][1]&&!isNaN(parseFloat(n.values[e]))});return e&&T.push(n),e?null:"none"}),(0<S.length||!nv.utils.arrayEquals(T,M))&&Q.activeChanged(T),w.select(".nv-brushBackground").each(function(e){d3.select(this).call(B[e.key].brush)}).selectAll("rect").attr("x",-8).attr("width",16)}),t}var F,O,w,A={top:30,right:0,bottom:10,left:0},D=null,P=null,V=d3.scale.ordinal(),B={},j=[],W=[],q=[],G=!0,H=nv.utils.defaultColor(),S=[],T=[],z=[],I=[],J=1,K=d3.svg.line(),L=d3.svg.axis(),Q=d3.dispatch("brush","brushEnd","dimensionsOrder","stateChange","elementClick","elementMouseover","elementMouseout","elementMousemove","renderEnd","activeChanged"),n=nv.utils.renderWatch(Q);return t.dispatch=Q,t.options=nv.utils.optionsFunc.bind(t),t._options=Object.create({},{width:{get:function(){return D},set:function(e){D=e}},height:{get:function(){return P},set:function(e){P=e}},dimensionData:{get:function(){return j},set:function(e){j=e}},displayBrush:{get:function(){return G},set:function(e){G=e}},filters:{get:function(){return S},set:function(e){S=e}},active:{get:function(){return T},set:function(e){T=e}},lineTension:{get:function(){return J},set:function(e){J=e}},dimensions:{get:function(){return j.map(function(e){return e.key})},set:function(e){nv.deprecated("dimensions","use dimensionData instead"),0===j.length?e.forEach(function(e){j.push({key:e})}):e.forEach(function(e,t){j[t].key=e})}},dimensionNames:{get:function(){return j.map(function(e){return e.key})},set:function(e){nv.deprecated("dimensionNames","use dimensionData instead"),q=[],0===j.length?e.forEach(function(e){j.push({key:e})}):e.forEach(function(e,t){j[t].key=e})}},dimensionFormats:{get:function(){return j.map(function(e){return e.format})},set:function(e){nv.deprecated("dimensionFormats","use dimensionData instead"),0===j.length?e.forEach(function(e){j.push({format:e})}):e.forEach(function(e,t){j[t].format=e})}},margin:{get:function(){return A},set:function(e){A.top=e.top!==undefined?e.top:A.top,A.right=e.right!==undefined?e.right:A.right,A.bottom=e.bottom!==undefined?e.bottom:A.bottom,A.left=e.left!==undefined?e.left:A.left}},color:{get:function(){return H},set:function(e){H=nv.utils.getColor(e)}}}),nv.utils.initOptions(t),t};