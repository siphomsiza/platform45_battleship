nv.models.parallelCoordinates=function(){"use strict";function e(E){return b.reset(),E.each(function(e){function b(e){return k(c.map(function(t){if(isNaN(e.values[t.key])||isNaN(parseFloat(e.values[t.key]))||j){var n=u[t.key].domain(),a=u[t.key].range(),r=n[0]-(n[1]-n[0])/9;if(y.indexOf(t.key)<0){var i=d3.scale.linear().domain([r,n[1]]).range([D-12,a[1]]);u[t.key].brush.y(i),y.push(t.key)}if(isNaN(e.values[t.key])||isNaN(parseFloat(e.values[t.key])))return[s(t.key),u[t.key](r)]}return void 0!==S&&(y.length>0||j?(S.style("display","inline"),T.style("display","inline")):(S.style("display","none"),T.style("display","none"))),[s(t.key),u[t.key](e.values[t.key])]}))}function E(){L=d.filter(function(e){return!u[e].brush.empty()}),Q=L.map(function(e){return u[e].brush.extent()}),v=[],L.forEach(function(e,t){v[t]={dimension:e,extent:Q[t],hasNaN:!1,hasOnlyNaN:!1}}),h=[],t.style("display",function(e){var t=L.every(function(t,n){return(isNaN(e.values[t])||isNaN(parseFloat(e.values[t])))&&Q[n][0]==u[t].brush.y().domain()[0]?!0:Q[n][0]<=e.values[t]&&e.values[t]<=Q[n][1]&&!isNaN(parseFloat(e.values[t]))});return t&&h.push(e),t?null:"none"}),x.brush({filters:v,active:h})}function C(){var e=L.length>0;v.forEach(function(e){e.extent[0]===u[e.dimension].brush.y().domain()[0]&&y.length>0&&(e.hasNaN=!0),e.extent[1]<u[e.dimension].domain()[0]&&(e.hasOnlyNaN=!0)}),x.brushEnd(h,e)}function _(e){p[e.key]=this.parentNode.__origin__=s(e.key),n.attr("visibility","hidden")}function M(e){p[e.key]=Math.min(A,Math.max(0,this.parentNode.__origin__+=d3.event.x)),t.attr("d",b),c.sort(function(e,t){return O(e.key)-O(t.key)}),c.forEach(function(e,t){return e.currentPosition=t}),s.domain(c.map(function(e){return e.key})),a.attr("transform",function(e){return"translate("+O(e.key)+")"})}function F(e){delete this.parentNode.__origin__,delete p[e.key],d3.select(this.parentNode).attr("transform","translate("+s(e.key)+")"),t.attr("d",b),n.attr("d",b).attr("visibility",null),x.dimensionsOrder(c)}function O(e){var t=p[e];return null==t?s(e):t}var w=d3.select(this),A=nv.utils.availableWidth(i,w,r),D=nv.utils.availableHeight(o,w,r);if(nv.utils.initSVG(w),void 0===e[0].values){var P=[];e.forEach(function(e){var t={},n=Object.keys(e);n.forEach(function(n){"name"!==n&&(t[n]=e[n])}),P.push({key:e.name,values:t})}),e=P}var V=e.map(function(e){return e.values});0===h.length&&(h=e),d=l.sort(function(e,t){return e.currentPosition-t.currentPosition}).map(function(e){return e.key}),c=l.filter(function(e){return!e.disabled}),s.rangePoints([0,A],1).domain(c.map(function(e){return e.key}));var B={},j=!1;d.forEach(function(e){var t=d3.extent(V,function(t){return+t[e]}),n=t[0],a=t[1],r=!1;(isNaN(n)||isNaN(a))&&(r=!0,n=0,a=0),n===a&&(n-=1,a+=1);var i=v.filter(function(t){return t.dimension==e});0!==i.length&&(r?(n=u[e].domain()[0],a=u[e].domain()[1]):!i[0].hasNaN&&f?(n=n>i[0].extent[0]?i[0].extent[0]:n,a=a<i[0].extent[1]?i[0].extent[1]:a):i[0].hasNaN&&(a=a<i[0].extent[1]?i[0].extent[1]:a,B[e]=u[e].domain()[1],j=!0)),u[e]=d3.scale.linear().domain([n,a]).range([.9*(D-12),0]),y=[],u[e].brush=d3.svg.brush().y(u[e]).on("brush",E).on("brushend",C)});var W=w.selectAll("g.nv-wrap.nv-parallelCoordinates").data([e]),q=W.enter().append("g").attr("class","nvd3 nv-wrap nv-parallelCoordinates"),G=q.append("g"),H=W.select("g");G.append("g").attr("class","nv-parallelCoordinates background"),G.append("g").attr("class","nv-parallelCoordinates foreground"),G.append("g").attr("class","nv-parallelCoordinates missingValuesline"),W.attr("transform","translate("+r.left+","+r.top+")"),k.interpolate("cardinal").tension(g),N.orient("left");var S,T,z=d3.behavior.drag().on("dragstart",_).on("drag",M).on("dragend",F),I=s.range()[1]-s.range()[0];if(!isNaN(I)){var J=[0+I/2,D-12,A-I/2,D-12];S=W.select(".missingValuesline").selectAll("line").data([J]),S.enter().append("line"),S.exit().remove(),S.attr("x1",function(e){return e[0]}).attr("y1",function(e){return e[1]}).attr("x2",function(e){return e[2]}).attr("y2",function(e){return e[3]}),T=W.select(".missingValuesline").selectAll("text").data(["undefined values"]),T.append("text").data(["undefined values"]),T.enter().append("text"),T.exit().remove(),T.attr("y",D).attr("x",A-92-I/2).text(function(e){return e})}n=W.select(".background").selectAll("path").data(e),n.enter().append("path"),n.exit().remove(),n.attr("d",b),t=W.select(".foreground").selectAll("path").data(e),t.enter().append("path"),t.exit().remove(),t.attr("d",b).style("stroke-width",function(e){return isNaN(e.stroke)&&(e.stroke=1),e.stroke}).attr("stroke",function(e,t){return e.color||m(e,t)}),t.on("mouseover",function(e,t){d3.select(this).classed("hover",!0).style("stroke-width",e.stroke+2+"px").style("stroke-opacity",1),x.elementMouseover({label:e.name,color:e.color||m(e,t)})}),t.on("mouseout",function(e,t){d3.select(this).classed("hover",!1).style("stroke-width",e.stroke+"px").style("stroke-opacity",.7),x.elementMouseout({label:e.name,index:t})}),t.on("mousemove",function(){x.elementMousemove()}),t.on("click",function(e){x.elementClick({id:e.id})}),a=H.selectAll(".dimension").data(c);var K=a.enter().append("g").attr("class","nv-parallelCoordinates dimension");a.attr("transform",function(e){return"translate("+s(e.key)+",0)"}),K.append("g").attr("class","nv-axis"),K.append("text").attr("class","nv-label").style("cursor","move").attr("dy","-1em").attr("text-anchor","middle").on("mouseover",function(e){x.elementMouseover({label:e.tooltip||e.key})}).on("mouseout",function(e){x.elementMouseout({label:e.tooltip})}).on("mousemove",function(){x.elementMousemove()}).call(z),K.append("g").attr("class","nv-brushBackground"),a.exit().remove(),a.select(".nv-label").text(function(e){return e.key}),a.select(".nv-axis").each(function(e){d3.select(this).call(N.scale(u[e.key]).tickFormat(d3.format(e.format)))}),v.forEach(function(e){var t=u[e.dimension].brush.y().domain();e.hasOnlyNaN&&(e.extent[1]=(u[e.dimension].domain()[1]-t[0])*(e.extent[1]-e.extent[0])/(B[e.dimension]-e.extent[0])+t[0]),e.hasNaN&&(e.extent[0]=t[0]),f&&u[e.dimension].brush.extent(e.extent)});var L=d.filter(function(e){return!u[e].brush.empty()}),Q=L.map(function(e){return u[e].brush.extent()}),R=h.slice(0);h=[],t.style("display",function(e){var t=L.every(function(t,n){return(isNaN(e.values[t])||isNaN(parseFloat(e.values[t])))&&Q[n][0]==u[t].brush.y().domain()[0]?!0:Q[n][0]<=e.values[t]&&e.values[t]<=Q[n][1]&&!isNaN(parseFloat(e.values[t]))});return t&&h.push(e),t?null:"none"}),(v.length>0||!nv.utils.arrayEquals(h,R))&&x.activeChanged(h),a.select(".nv-brushBackground").each(function(e){d3.select(this).call(u[e.key].brush)}).selectAll("rect").attr("x",-8).attr("width",16)}),e}var t,n,a,r={top:30,right:0,bottom:10,left:0},i=null,o=null,s=d3.scale.ordinal(),u={},l=[],c=[],d=[],f=!0,m=nv.utils.defaultColor(),v=[],h=[],p=[],y=[],g=1,k=d3.svg.line(),N=d3.svg.axis(),x=d3.dispatch("brush","brushEnd","dimensionsOrder","stateChange","elementClick","elementMouseover","elementMouseout","elementMousemove","renderEnd","activeChanged"),b=nv.utils.renderWatch(x);return e.dispatch=x,e.options=nv.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return i},set:function(e){i=e}},height:{get:function(){return o},set:function(e){o=e}},dimensionData:{get:function(){return l},set:function(e){l=e}},displayBrush:{get:function(){return f},set:function(e){f=e}},filters:{get:function(){return v},set:function(e){v=e}},active:{get:function(){return h},set:function(e){h=e}},lineTension:{get:function(){return g},set:function(e){g=e}},dimensions:{get:function(){return l.map(function(e){return e.key})},set:function(e){nv.deprecated("dimensions","use dimensionData instead"),0===l.length?e.forEach(function(e){l.push({key:e})}):e.forEach(function(e,t){l[t].key=e})}},dimensionNames:{get:function(){return l.map(function(e){return e.key})},set:function(e){nv.deprecated("dimensionNames","use dimensionData instead"),d=[],0===l.length?e.forEach(function(e){l.push({key:e})}):e.forEach(function(e,t){l[t].key=e})}},dimensionFormats:{get:function(){return l.map(function(e){return e.format})},set:function(e){nv.deprecated("dimensionFormats","use dimensionData instead"),0===l.length?e.forEach(function(e){l.push({format:e})}):e.forEach(function(e,t){l[t].format=e})}},margin:{get:function(){return r},set:function(e){r.top=void 0!==e.top?e.top:r.top,r.right=void 0!==e.right?e.right:r.right,r.bottom=void 0!==e.bottom?e.bottom:r.bottom,r.left=void 0!==e.left?e.left:r.left}},color:{get:function(){return m},set:function(e){m=nv.utils.getColor(e)}}}),nv.utils.initOptions(e),e};