nv.models.multiBarChart=function(){"use strict";function g(t){return a.reset(),a.models(m),L&&a.models(k),B&&a.models(x),t.each(function(a){var t=d3.select(this);nv.utils.initSVG(t);var e,n=nv.utils.availableWidth(w,t,A),i=nv.utils.availableHeight(C,t,A);if(g.update=function(){0===H?t.call(g):t.transition().duration(H).call(g)},g.container=this,X.setter(V(a),g.update).getter(P(a)).update(),X.disabled=a.map(function(t){return!!t.disabled}),!Y)for(e in Y={},X)X[e]instanceof Array?Y[e]=X[e].slice(0):Y[e]=X[e];if(!(a&&a.length&&a.filter(function(t){return t.values.length}).length))return nv.utils.noData(g,t),g;t.selectAll(".nv-noData").remove(),p=m.xScale(),h=m.yScale();var r=t.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([a]),o=r.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g"),s=r.select("g");if(o.append("g").attr("class","nv-x nv-axis"),o.append("g").attr("class","nv-y nv-axis"),o.append("g").attr("class","nv-barsWrap"),o.append("g").attr("class","nv-legendWrap"),o.append("g").attr("class","nv-controlsWrap"),F&&(b.width(n-z()),s.select(".nv-legendWrap").datum(a).call(b),A.top!=b.height()&&(A.top=b.height(),i=nv.utils.availableHeight(C,t,A)),s.select(".nv-legendWrap").attr("transform","translate("+z()+","+-A.top+")")),W){var l=[{key:M.grouped||"Grouped",disabled:m.stacked()},{key:M.stacked||"Stacked",disabled:!m.stacked()}];y.width(z()).color(["#444","#444","#444"]),s.select(".nv-controlsWrap").datum(l).attr("transform","translate(0,"+-A.top+")").call(y)}if(r.attr("transform","translate("+A.left+","+A.top+")"),E&&s.select(".nv-y.nv-axis").attr("transform","translate("+n+",0)"),m.disabled(a.map(function(t){return t.disabled})).width(n).height(i).color(a.map(function(t,e){return t.color||S(t,e)}).filter(function(t,e){return!a[e].disabled})),s.select(".nv-barsWrap").datum(a.filter(function(t){return!t.disabled})).call(m),L){k.scale(p)._ticks(nv.utils.calcTicksX(n/100,a)).tickSize(-i,0),s.select(".nv-x.nv-axis").attr("transform","translate(0,"+h.range()[0]+")"),s.select(".nv-x.nv-axis").call(k);var c=s.select(".nv-x.nv-axis > g").selectAll("g");if(c.selectAll("line, text").style("opacity",1),D){var u=function(t,e){return"translate("+t+","+e+")"},d=5,f=17;c.selectAll("text").attr("transform",function(t,e,n){return u(0,n%2==0?d:f)});var v=d3.selectAll(".nv-x.nv-axis .nv-wrap g g text")[0].length;s.selectAll(".nv-x.nv-axis .nv-axisMaxMin text").attr("transform",function(t,e){return u(0,0===e||v%2!=0?f:d)})}G&&s.selectAll(".tick text").call(nv.utils.wrapTicks,g.xAxis.rangeBand()),T&&c.filter(function(t,e){return e%Math.ceil(a[0].values.length/(n/100))!=0}).selectAll("text, line").style("opacity",0),O&&c.selectAll(".tick text").attr("transform","rotate("+O+" 0,0)").style("text-anchor",0<O?"start":"end"),s.select(".nv-x.nv-axis").selectAll("g.nv-axisMaxMin text").style("opacity",1)}B&&(x.scale(h)._ticks(nv.utils.calcTicksY(i/36,a)).tickSize(-n,0),s.select(".nv-y.nv-axis").call(x)),b.dispatch.on("stateChange",function(t){for(var e in t)X[e]=t[e];_.stateChange(X),g.update()}),y.dispatch.on("legendClick",function(t){if(t.disabled){switch(l=l.map(function(t){return t.disabled=!0,t}),t.disabled=!1,t.key){case"Grouped":case M.grouped:m.stacked(!1);break;case"Stacked":case M.stacked:m.stacked(!0)}X.stacked=m.stacked(),_.stateChange(X),g.update()}}),_.on("changeState",function(n){"undefined"!=typeof n.disabled&&(a.forEach(function(t,e){t.disabled=n.disabled[e]}),X.disabled=n.disabled),"undefined"!=typeof n.stacked&&(m.stacked(n.stacked),X.stacked=n.stacked,j=n.stacked),g.update()})}),a.renderEnd("multibarchart immediate"),g}var p,h,m=nv.models.multiBar(),k=nv.models.axis(),x=nv.models.axis(),b=nv.models.legend(),y=nv.models.legend(),e=nv.models.tooltip(),A={top:30,right:20,bottom:50,left:60},w=null,C=null,S=nv.utils.defaultColor(),W=!0,M={},F=!0,L=!0,B=!0,E=!1,T=!0,D=!1,G=!1,O=0,X=nv.utils.state(),Y=null,n=null,_=d3.dispatch("stateChange","changeState","renderEnd"),z=function(){return W?180:0},H=250;X.stacked=!1,m.stacked(!1),k.orient("bottom").tickPadding(7).showMaxMin(!1).tickFormat(function(t){return t}),x.orient(E?"right":"left").tickFormat(d3.format(",.1f")),e.duration(0).valueFormatter(function(t,e){return x.tickFormat()(t,e)}).headerFormatter(function(t,e){return k.tickFormat()(t,e)}),y.updateState(!1);var a=nv.utils.renderWatch(_),j=!1,P=function(t){return function(){return{active:t.map(function(t){return!t.disabled}),stacked:j}}},V=function(t){return function(n){n.stacked!==undefined&&(j=n.stacked),n.active!==undefined&&t.forEach(function(t,e){t.disabled=!n.active[e]})}};return m.dispatch.on("elementMouseover.tooltip",function(t){t.value=g.x()(t.data),t.series={key:t.data.key,value:g.y()(t.data),color:t.color},e.data(t).hidden(!1)}),m.dispatch.on("elementMouseout.tooltip",function(){e.hidden(!0)}),m.dispatch.on("elementMousemove.tooltip",function(){e()}),g.dispatch=_,g.multibar=m,g.legend=b,g.controls=y,g.xAxis=k,g.yAxis=x,g.state=X,g.tooltip=e,g.options=nv.utils.optionsFunc.bind(g),g._options=Object.create({},{width:{get:function(){return w},set:function(t){w=t}},height:{get:function(){return C},set:function(t){C=t}},showLegend:{get:function(){return F},set:function(t){F=t}},showControls:{get:function(){return W},set:function(t){W=t}},controlLabels:{get:function(){return M},set:function(t){M=t}},showXAxis:{get:function(){return L},set:function(t){L=t}},showYAxis:{get:function(){return B},set:function(t){B=t}},defaultState:{get:function(){return Y},set:function(t){Y=t}},noData:{get:function(){return n},set:function(t){n=t}},reduceXTicks:{get:function(){return T},set:function(t){T=t}},rotateLabels:{get:function(){return O},set:function(t){O=t}},staggerLabels:{get:function(){return D},set:function(t){D=t}},wrapLabels:{get:function(){return G},set:function(t){G=!!t}},margin:{get:function(){return A},set:function(t){A.top=t.top!==undefined?t.top:A.top,A.right=t.right!==undefined?t.right:A.right,A.bottom=t.bottom!==undefined?t.bottom:A.bottom,A.left=t.left!==undefined?t.left:A.left}},duration:{get:function(){return H},set:function(t){H=t,m.duration(H),k.duration(H),x.duration(H),a.reset(H)}},color:{get:function(){return S},set:function(t){S=nv.utils.getColor(t),b.color(S)}},rightAlignYAxis:{get:function(){return E},set:function(t){E=t,x.orient(E?"right":"left")}},barColor:{get:function(){return m.barColor},set:function(t){m.barColor(t),b.color(function(t,e){return d3.rgb("#ccc").darker(1.5*e).toString()})}}}),nv.utils.inheritOptions(g,m),nv.utils.initOptions(g),g};