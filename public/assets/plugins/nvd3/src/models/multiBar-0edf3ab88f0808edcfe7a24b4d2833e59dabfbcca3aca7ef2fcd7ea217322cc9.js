nv.models.multiBar=function(){"use strict";function t(A){return E.reset(),A.each(function(t){var A=l-c.left-c.right,D=s-c.top-c.bottom;v=d3.select(this),nv.utils.initSVG(v);var O=0;if(S&&t.length&&(S=[{values:t[0].values.map(function(t){return{x:t.x,y:0,series:t.series,size:.01}})}]),b){var P=d3.layout.stack().offset(k).values(function(t){return t.values}).y(h)(!t.length&&S?S:t);P.forEach(function(n,e){n.nonStackable?(t[e].nonStackableSeries=O++,P[e]=t[e]):e>0&&P[e-1].nonStackable&&P[e].values.map(function(t,n){t.y0-=P[e-1].values[n].y,t.y1=t.y0+t.y})}),t=P}t.forEach(function(t,n){t.values.forEach(function(e){e.series=n,e.key=t.key})}),b&&t[0].values.map(function(n,e){var r=0,a=0;t.map(function(n,i){if(!t[i].nonStackable){var o=n.values[e];o.size=Math.abs(o.y),o.y<0?(o.y1=a,a-=o.size):(o.y1=o.size+r,r+=o.size)}})});var R=e&&r?[]:t.map(function(t,n){return t.values.map(function(t,e){return{x:m(t,e),y:h(t,e),y0:t.y0,y1:t.y1,idx:n}})});f.domain(e||d3.merge(R).map(function(t){return t.x})).rangeBands(a||[0,A],C),d.domain(r||d3.extent(d3.merge(R).map(function(n){var e=n.y;return b&&!t[n.idx].nonStackable&&(e=n.y>0?n.y1:n.y1+n.y),e}).concat(p))).range(i||[D,0]),f.domain()[0]===f.domain()[1]&&(f.domain()[0]?f.domain([f.domain()[0]-.01*f.domain()[0],f.domain()[1]+.01*f.domain()[1]]):f.domain([-1,1])),d.domain()[0]===d.domain()[1]&&(d.domain()[0]?d.domain([d.domain()[0]+.01*d.domain()[0],d.domain()[1]-.01*d.domain()[1]]):d.domain([-1,1])),o=o||f,u=u||d;var j=v.selectAll("g.nv-wrap.nv-multibar").data([t]),F=j.enter().append("g").attr("class","nvd3 nv-wrap nv-multibar"),G=F.append("defs"),T=F.append("g"),V=j.select("g");T.append("g").attr("class","nv-groups"),j.attr("transform","translate("+c.left+","+c.top+")"),G.append("clipPath").attr("id","nv-edge-clip-"+g).append("rect"),j.select("#nv-edge-clip-"+g+" rect").attr("width",A).attr("height",D),V.attr("clip-path",y?"url(#nv-edge-clip-"+g+")":"");var W=j.select(".nv-groups").selectAll(".nv-group").data(function(t){return t},function(t,n){return n});W.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);var Y=E.transition(W.exit().selectAll("rect.nv-bar"),"multibarExit",Math.min(100,B)).attr("y",function(n){var e=u(0)||0;return b&&t[n.series]&&!t[n.series].nonStackable&&(e=u(n.y0)),e}).attr("height",0).remove();Y.delay&&Y.delay(function(t,n){var e=n*(B/(z+1))-n;return e}),W.attr("class",function(t,n){return"nv-group nv-series-"+n}).classed("hover",function(t){return t.hover}).style("fill",function(t,n){return x(t,n)}).style("stroke",function(t,n){return x(t,n)}),W.style("stroke-opacity",1).style("fill-opacity",.75);var _=W.selectAll("rect.nv-bar").data(function(n){return S&&!t.length?S.values:n.values});_.exit().remove();_.enter().append("rect").attr("class",function(t,n){return h(t,n)<0?"nv-bar negative":"nv-bar positive"}).attr("x",function(n,e,r){return b&&!t[r].nonStackable?0:r*f.rangeBand()/t.length}).attr("y",function(n,e,r){return u(b&&!t[r].nonStackable?n.y0:0)||0}).attr("height",0).attr("width",function(n,e,r){return f.rangeBand()/(b&&!t[r].nonStackable?1:t.length)}).attr("transform",function(t,n){return"translate("+f(m(t,n))+",0)"});_.style("fill",function(t,n,e){return x(t,e,n)}).style("stroke",function(t,n,e){return x(t,e,n)}).on("mouseover",function(t,n){d3.select(this).classed("hover",!0),w.elementMouseover({data:t,index:n,color:d3.select(this).style("fill")})}).on("mouseout",function(t,n){d3.select(this).classed("hover",!1),w.elementMouseout({data:t,index:n,color:d3.select(this).style("fill")})}).on("mousemove",function(t,n){w.elementMousemove({data:t,index:n,color:d3.select(this).style("fill")})}).on("click",function(t,n){var e=this;w.elementClick({data:t,index:n,color:d3.select(this).style("fill"),event:d3.event,element:e}),d3.event.stopPropagation()}).on("dblclick",function(t,n){w.elementDblClick({data:t,index:n,color:d3.select(this).style("fill")}),d3.event.stopPropagation()}),_.attr("class",function(t,n){return h(t,n)<0?"nv-bar negative":"nv-bar positive"}).attr("transform",function(t,n){return"translate("+f(m(t,n))+",0)"}),M&&(n||(n=t.map(function(){return!0})),_.style("fill",function(t,e,r){return d3.rgb(M(t,e)).darker(n.map(function(t,n){return n}).filter(function(t,e){return!n[e]})[r]).toString()}).style("stroke",function(t,e,r){return d3.rgb(M(t,e)).darker(n.map(function(t,n){return n}).filter(function(t,e){return!n[e]})[r]).toString()}));var q=_.watchTransition(E,"multibar",Math.min(250,B)).delay(function(n,e){return e*B/t[0].values.length});b?q.attr("y",function(n,e,r){var a=0;return a=t[r].nonStackable?h(n,e)<0?d(0):d(0)-d(h(n,e))<-1?d(0)-1:d(h(n,e))||0:d(n.y1)}).attr("height",function(n,e,r){return t[r].nonStackable?Math.max(Math.abs(d(h(n,e))-d(0)),0)||0:Math.max(Math.abs(d(n.y+n.y0)-d(n.y0)),0)}).attr("x",function(n,e,r){var a=0;return t[r].nonStackable&&(a=n.series*f.rangeBand()/t.length,t.length!==O&&(a=t[r].nonStackableSeries*f.rangeBand()/(2*O))),a}).attr("width",function(n,e,r){if(t[r].nonStackable){var a=f.rangeBand()/O;return t.length!==O&&(a=f.rangeBand()/(2*O)),a}return f.rangeBand()}):q.attr("x",function(n){return n.series*f.rangeBand()/t.length}).attr("width",f.rangeBand()/t.length).attr("y",function(t,n){return h(t,n)<0?d(0):d(0)-d(h(t,n))<1?d(0)-1:d(h(t,n))||0}).attr("height",function(t,n){return Math.max(Math.abs(d(h(t,n))-d(0)),1)||0}),o=f.copy(),u=d.copy(),t[0]&&t[0].values&&(z=t[0].values.length)}),E.renderEnd("multibar immediate"),t}var n,e,r,a,i,o,u,c={top:0,right:0,bottom:0,left:0},l=960,s=500,f=d3.scale.ordinal(),d=d3.scale.linear(),g=Math.floor(1e4*Math.random()),v=null,m=function(t){return t.x},h=function(t){return t.y},p=[0],y=!0,b=!1,k="zero",x=nv.utils.defaultColor(),S=!1,M=null,B=500,C=.1,w=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),E=nv.utils.renderWatch(w,B),z=0;return t.dispatch=w,t.options=nv.utils.optionsFunc.bind(t),t._options=Object.create({},{width:{get:function(){return l},set:function(t){l=t}},height:{get:function(){return s},set:function(t){s=t}},x:{get:function(){return m},set:function(t){m=t}},y:{get:function(){return h},set:function(t){h=t}},xScale:{get:function(){return f},set:function(t){f=t}},yScale:{get:function(){return d},set:function(t){d=t}},xDomain:{get:function(){return e},set:function(t){e=t}},yDomain:{get:function(){return r},set:function(t){r=t}},xRange:{get:function(){return a},set:function(t){a=t}},yRange:{get:function(){return i},set:function(t){i=t}},forceY:{get:function(){return p},set:function(t){p=t}},stacked:{get:function(){return b},set:function(t){b=t}},stackOffset:{get:function(){return k},set:function(t){k=t}},clipEdge:{get:function(){return y},set:function(t){y=t}},disabled:{get:function(){return n},set:function(t){n=t}},id:{get:function(){return g},set:function(t){g=t}},hideable:{get:function(){return S},set:function(t){S=t}},groupSpacing:{get:function(){return C},set:function(t){C=t}},margin:{get:function(){return c},set:function(t){c.top=void 0!==t.top?t.top:c.top,c.right=void 0!==t.right?t.right:c.right,c.bottom=void 0!==t.bottom?t.bottom:c.bottom,c.left=void 0!==t.left?t.left:c.left}},duration:{get:function(){return B},set:function(t){B=t,E.reset(B)}},color:{get:function(){return x},set:function(t){x=nv.utils.getColor(t)}},barColor:{get:function(){return M},set:function(t){M=t?nv.utils.getColor(t):null}}}),nv.utils.initOptions(t),t};