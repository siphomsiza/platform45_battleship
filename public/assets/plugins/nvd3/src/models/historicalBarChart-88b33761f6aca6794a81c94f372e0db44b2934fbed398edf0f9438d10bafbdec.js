nv.models.historicalBarChart=function(t){"use strict";function c(d){return d.each(function(l){H.reset(),H.models(v),C&&H.models(f),F&&H.models(p);var t=d3.select(this),e=this;nv.utils.initSVG(t);var n,i=nv.utils.availableWidth(k,t,b),a=nv.utils.availableHeight(y,t,b);if(c.update=function(){t.transition().duration(E).call(c)},c.container=this,S.disabled=l.map(function(t){return!!t.disabled}),!G)for(n in G={},S)S[n]instanceof Array?G[n]=S[n].slice(0):G[n]=S[n];if(!(l&&l.length&&l.filter(function(t){return t.values.length}).length))return nv.utils.noData(c,t),c;t.selectAll(".nv-noData").remove(),u=v.xScale(),h=v.yScale();var r=t.selectAll("g.nv-wrap.nv-historicalBarChart").data([l]),o=r.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBarChart").append("g"),s=r.select("g");o.append("g").attr("class","nv-x nv-axis"),o.append("g").attr("class","nv-y nv-axis"),o.append("g").attr("class","nv-barsWrap"),o.append("g").attr("class","nv-legendWrap"),o.append("g").attr("class","nv-interactive"),A&&(g.width(i),s.select(".nv-legendWrap").datum(l).call(g),b.top!=g.height()&&(b.top=g.height(),a=nv.utils.availableHeight(y,t,b)),r.select(".nv-legendWrap").attr("transform","translate(0,"+-b.top+")")),r.attr("transform","translate("+b.left+","+b.top+")"),w&&s.select(".nv-y.nv-axis").attr("transform","translate("+i+",0)"),B&&(m.width(i).height(a).margin({left:b.left,top:b.top}).svgContainer(t).xScale(u),r.select(".nv-interactive").call(m)),v.width(i).height(a).color(l.map(function(t,e){return t.color||x(t,e)}).filter(function(t,e){return!l[e].disabled})),s.select(".nv-barsWrap").datum(l.filter(function(t){return!t.disabled})).transition().call(v),C&&(f.scale(u)._ticks(nv.utils.calcTicksX(i/100,l)).tickSize(-a,0),s.select(".nv-x.nv-axis").attr("transform","translate(0,"+h.range()[0]+")"),s.select(".nv-x.nv-axis").transition().call(f)),F&&(p.scale(h)._ticks(nv.utils.calcTicksY(a/36,l)).tickSize(-i,0),s.select(".nv-y.nv-axis").transition().call(p)),m.dispatch.on("elementMousemove",function(n){v.clearHighlights();var i,a,r,o=[];l.filter(function(t,e){return t.seriesIndex=e,!t.disabled}).forEach(function(t){a=nv.interactiveBisect(t.values,n.pointXValue,c.x()),v.highlightPoint(a,!0);var e=t.values[a];e!==undefined&&(i===undefined&&(i=e),r===undefined&&(r=c.xScale()(c.x()(e,a))),o.push({key:t.key,value:c.y()(e,a),color:x(t,t.seriesIndex),data:t.values[a]}))});var t=f.tickFormat()(c.x()(i,a));m.tooltip.chartContainer(e.parentNode).valueFormatter(function(t){return p.tickFormat()(t)}).data({value:t,index:a,series:o})(),m.renderGuideLine(r)}),m.dispatch.on("elementMouseout",function(){W.tooltipHide(),v.clearHighlights()}),g.dispatch.on("legendClick",function(t){t.disabled=!t.disabled,l.filter(function(t){return!t.disabled}).length||l.map(function(t){return t.disabled=!1,r.selectAll(".nv-series").classed("disabled",!1),t}),S.disabled=l.map(function(t){return!!t.disabled}),W.stateChange(S),d.transition().call(c)}),g.dispatch.on("legendDblclick",function(t){l.forEach(function(t){t.disabled=!0}),t.disabled=!1,S.disabled=l.map(function(t){return!!t.disabled}),W.stateChange(S),c.update()}),W.on("changeState",function(n){"undefined"!=typeof n.disabled&&(l.forEach(function(t,e){t.disabled=n.disabled[e]}),S.disabled=n.disabled),c.update()})}),H.renderEnd("historicalBarChart immediate"),c}var u,h,v=t||nv.models.historicalBar(),f=nv.models.axis(),p=nv.models.axis(),g=nv.models.legend(),m=nv.interactiveGuideline(),e=nv.models.tooltip(),b={top:30,right:90,bottom:50,left:90},x=nv.utils.defaultColor(),k=null,y=null,A=!1,C=!0,F=!0,w=!1,B=!1,S={},G=null,n=null,W=d3.dispatch("tooltipHide","stateChange","changeState","renderEnd"),E=250;f.orient("bottom").tickPadding(7),p.orient(w?"right":"left"),e.duration(0).headerEnabled(!1).valueFormatter(function(t,e){return p.tickFormat()(t,e)}).headerFormatter(function(t,e){return f.tickFormat()(t,e)});var H=nv.utils.renderWatch(W,0);return v.dispatch.on("elementMouseover.tooltip",function(t){t.series={key:c.x()(t.data),value:c.y()(t.data),color:t.color},e.data(t).hidden(!1)}),v.dispatch.on("elementMouseout.tooltip",function(){e.hidden(!0)}),v.dispatch.on("elementMousemove.tooltip",function(){e()}),c.dispatch=W,c.bars=v,c.legend=g,c.xAxis=f,c.yAxis=p,c.interactiveLayer=m,c.tooltip=e,c.options=nv.utils.optionsFunc.bind(c),c._options=Object.create({},{width:{get:function(){return k},set:function(t){k=t}},height:{get:function(){return y},set:function(t){y=t}},showLegend:{get:function(){return A},set:function(t){A=t}},showXAxis:{get:function(){return C},set:function(t){C=t}},showYAxis:{get:function(){return F},set:function(t){F=t}},defaultState:{get:function(){return G},set:function(t){G=t}},noData:{get:function(){return n},set:function(t){n=t}},margin:{get:function(){return b},set:function(t){b.top=t.top!==undefined?t.top:b.top,b.right=t.right!==undefined?t.right:b.right,b.bottom=t.bottom!==undefined?t.bottom:b.bottom,b.left=t.left!==undefined?t.left:b.left}},color:{get:function(){return x},set:function(t){x=nv.utils.getColor(t),g.color(x),v.color(x)}},duration:{get:function(){return E},set:function(t){E=t,H.reset(E),p.duration(E),f.duration(E)}},rightAlignYAxis:{get:function(){return w},set:function(t){w=t,p.orient(t?"right":"left")}},useInteractiveGuideline:{get:function(){return B},set:function(t){!0===(B=t)&&c.interactive(!1)}}}),nv.utils.inheritOptions(c,v),nv.utils.initOptions(c),c},nv.models.ohlcBarChart=function(){var n=nv.models.historicalBarChart(nv.models.ohlcBar());return n.useInteractiveGuideline(!0),n.interactiveLayer.tooltip.contentGenerator(function(t){var e=t.series[0].data;return'<h3 style="color: #'+(e.open<e.close?"2ca02c":"d62728")+'">'+t.value+"</h3><table><tr><td>open:</td><td>"+n.yAxis.tickFormat()(e.open)+"</td></tr><tr><td>close:</td><td>"+n.yAxis.tickFormat()(e.close)+"</td></tr><tr><td>high</td><td>"+n.yAxis.tickFormat()(e.high)+"</td></tr><tr><td>low:</td><td>"+n.yAxis.tickFormat()(e.low)+"</td></tr></table>"}),n},nv.models.candlestickBarChart=function(){var n=nv.models.historicalBarChart(nv.models.candlestickBar());return n.useInteractiveGuideline(!0),n.interactiveLayer.tooltip.contentGenerator(function(t){var e=t.series[0].data;return'<h3 style="color: #'+(e.open<e.close?"2ca02c":"d62728")+'">'+t.value+"</h3><table><tr><td>open:</td><td>"+n.yAxis.tickFormat()(e.open)+"</td></tr><tr><td>close:</td><td>"+n.yAxis.tickFormat()(e.close)+"</td></tr><tr><td>high</td><td>"+n.yAxis.tickFormat()(e.high)+"</td></tr><tr><td>low:</td><td>"+n.yAxis.tickFormat()(e.low)+"</td></tr></table>"}),n};