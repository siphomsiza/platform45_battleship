nv.models.pie=function(){"use strict";function t(I){return C.reset(),I.each(function(t){function I(t,e){t.endAngle=isNaN(t.endAngle)?0:t.endAngle,t.startAngle=isNaN(t.startAngle)?0:t.startAngle,p||(t.innerRadius=0);var n=d3.interpolate(this._current,t);return this._current=n(0),function(t){return L[e](n(t))}}var P=n-e.left-e.right,F=r-e.top-e.bottom,N=Math.min(P,F)/2,T=[],_=[];if(o=d3.select(this),0===k.length)for(var D=N-N/5,E=M*N,S=0;S<t[0].length;S++)T.push(D),_.push(E);else T=k.map(function(t){return(t.outer-t.outer/5)*N}),_=k.map(function(t){return(t.inner-t.inner/5)*N}),M=d3.min(k.map(function(t){return t.inner-t.inner/5}));nv.utils.initSVG(o);var j=o.selectAll(".nv-wrap.nv-pie").data(t),z=j.enter().append("g").attr("class","nvd3 nv-wrap nv-pie nv-chart-"+u),G=z.append("g"),H=j.select("g"),V=G.append("g").attr("class","nv-pie");G.append("g").attr("class","nv-pieLabels"),j.attr("transform","translate("+e.left+","+e.top+")"),H.select(".nv-pie").attr("transform","translate("+P/2+","+F/2+")"),H.select(".nv-pieLabels").attr("transform","translate("+P/2+","+F/2+")"),o.on("click",function(t,e){O.chartClick({data:t,index:e,pos:d3.event,id:u})}),L=[],w=[];for(var S=0;S<t[0].length;S++){var W=d3.svg.arc().outerRadius(T[S]),q=d3.svg.arc().outerRadius(T[S]+5);A!==!1&&(W.startAngle(A),q.startAngle(A)),R!==!1&&(W.endAngle(R),q.endAngle(R)),p&&(W.innerRadius(_[S]),q.innerRadius(_[S])),W.cornerRadius&&x&&(W.cornerRadius(x),q.cornerRadius(x)),L.push(W),w.push(q)}var B=d3.layout.pie().sort(null).value(function(t){return t.disabled?0:i(t)});B.padAngle&&y&&B.padAngle(y),p&&v&&(V.append("text").attr("class","nv-pie-title"),j.select(".nv-pie-title").style("text-anchor","middle").text(function(){return v}).style("font-size",Math.min(P,F)*M*2/(v.length+2)+"px").attr("dy","0.35em").attr("transform",function(){return"translate(0, "+m+")"}));var J=j.select(".nv-pie").selectAll(".nv-slice").data(B),K=j.select(".nv-pieLabels").selectAll(".nv-label").data(B);J.exit().remove(),K.exit().remove();var Q=J.enter().append("g");Q.attr("class","nv-slice"),Q.on("mouseover",function(t,e){d3.select(this).classed("hover",!0),h&&d3.select(this).select("path").transition().duration(70).attr("d",w[e]),O.elementMouseover({data:t.data,index:e,color:d3.select(this).style("fill")})}),Q.on("mouseout",function(t,e){d3.select(this).classed("hover",!1),h&&d3.select(this).select("path").transition().duration(50).attr("d",L[e]),O.elementMouseout({data:t.data,index:e})}),Q.on("mousemove",function(t,e){O.elementMousemove({data:t.data,index:e})}),Q.on("click",function(t,e){var n=this;O.elementClick({data:t.data,index:e,color:d3.select(this).style("fill"),event:d3.event,element:n})}),Q.on("dblclick",function(t,e){O.elementDblClick({data:t.data,index:e,color:d3.select(this).style("fill")})}),J.attr("fill",function(t,e){return s(t.data,e)}),J.attr("stroke",function(t,e){return s(t.data,e)});Q.append("path").each(function(t){this._current=t});if(J.select("path").transition().attr("d",function(t,e){return L[e](t)}).attrTween("d",I),c){for(var U=[],S=0;S<t[0].length;S++)U.push(L[S]),d?p&&(U[S]=d3.svg.arc().outerRadius(L[S].outerRadius()),A!==!1&&U[S].startAngle(A),R!==!1&&U[S].endAngle(R)):p||U[S].innerRadius(0);K.enter().append("g").classed("nv-label",!0).each(function(t){var e=d3.select(this);e.attr("transform",function(t,e){if(b){t.outerRadius=T[e]+10,t.innerRadius=T[e]+15;var n=(t.startAngle+t.endAngle)/2*(180/Math.PI);return(t.startAngle+t.endAngle)/2<Math.PI?n-=90:n+=90,"translate("+U[e].centroid(t)+") rotate("+n+")"}return t.outerRadius=N+10,t.innerRadius=N+15,"translate("+U[e].centroid(t)+")"}),e.append("rect").style("stroke","#fff").style("fill","#fff").attr("rx",3).attr("ry",3),e.append("text").style("text-anchor",b?(t.startAngle+t.endAngle)/2<Math.PI?"start":"end":"middle").style("fill","#000")});var X={},Y=14,Z=140,$=function(t){return Math.floor(t[0]/Z)*Z+","+Math.floor(t[1]/Y)*Y};K.watchTransition(C,"pie labels").attr("transform",function(t,e){if(b){t.outerRadius=T[e]+10,t.innerRadius=T[e]+15;var n=(t.startAngle+t.endAngle)/2*(180/Math.PI);return(t.startAngle+t.endAngle)/2<Math.PI?n-=90:n+=90,"translate("+U[e].centroid(t)+") rotate("+n+")"}t.outerRadius=N+10,t.innerRadius=N+15;var r=U[e].centroid(t);if(t.value){var a=$(r);X[a]&&(r[1]-=Y),X[$(r)]=!0}return"translate("+r+")"}),K.select(".nv-label text").style("text-anchor",function(t){return b?(t.startAngle+t.endAngle)/2<Math.PI?"start":"end":"middle"}).text(function(t,e){var n=(t.endAngle-t.startAngle)/(2*Math.PI),r="";if(!t.value||g>n)return"";if("function"==typeof f)r=f(t,e,{key:a(t.data),value:i(t.data),percent:l(n)});else switch(f){case"key":r=a(t.data);break;case"value":r=l(i(t.data));break;case"percent":r=d3.format("%")(n)}return r})}}),C.renderEnd("pie immediate"),t}var e={top:0,right:0,bottom:0,left:0},n=500,r=500,a=function(t){return t.x},i=function(t){return t.y},u=Math.floor(1e4*Math.random()),o=null,s=nv.utils.defaultColor(),l=d3.format(",.2f"),c=!0,d=!1,f="key",g=.02,p=!1,v=!1,h=!0,m=0,b=!1,A=!1,y=!1,R=!1,x=0,M=.5,k=[],O=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),L=[],w=[],C=nv.utils.renderWatch(O);return t.dispatch=O,t.options=nv.utils.optionsFunc.bind(t),t._options=Object.create({},{arcsRadius:{get:function(){return k},set:function(t){k=t}},width:{get:function(){return n},set:function(t){n=t}},height:{get:function(){return r},set:function(t){r=t}},showLabels:{get:function(){return c},set:function(t){c=t}},title:{get:function(){return v},set:function(t){v=t}},titleOffset:{get:function(){return m},set:function(t){m=t}},labelThreshold:{get:function(){return g},set:function(t){g=t}},valueFormat:{get:function(){return l},set:function(t){l=t}},x:{get:function(){return a},set:function(t){a=t}},id:{get:function(){return u},set:function(t){u=t}},endAngle:{get:function(){return R},set:function(t){R=t}},startAngle:{get:function(){return A},set:function(t){A=t}},padAngle:{get:function(){return y},set:function(t){y=t}},cornerRadius:{get:function(){return x},set:function(t){x=t}},donutRatio:{get:function(){return M},set:function(t){M=t}},labelsOutside:{get:function(){return d},set:function(t){d=t}},labelSunbeamLayout:{get:function(){return b},set:function(t){b=t}},donut:{get:function(){return p},set:function(t){p=t}},growOnHover:{get:function(){return h},set:function(t){h=t}},pieLabelsOutside:{get:function(){return d},set:function(t){d=t,nv.deprecated("pieLabelsOutside","use labelsOutside instead")}},donutLabelsOutside:{get:function(){return d},set:function(t){d=t,nv.deprecated("donutLabelsOutside","use labelsOutside instead")}},labelFormat:{get:function(){return l},set:function(t){l=t,nv.deprecated("labelFormat","use valueFormat instead")}},margin:{get:function(){return e},set:function(t){e.top="undefined"!=typeof t.top?t.top:e.top,e.right="undefined"!=typeof t.right?t.right:e.right,e.bottom="undefined"!=typeof t.bottom?t.bottom:e.bottom,e.left="undefined"!=typeof t.left?t.left:e.left}},y:{get:function(){return i},set:function(t){i=d3.functor(t)}},color:{get:function(){return s},set:function(t){s=nv.utils.getColor(t)}},labelType:{get:function(){return f},set:function(t){f=t||"key"}}}),nv.utils.initOptions(t),t};