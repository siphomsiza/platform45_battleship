(function(){var o=function(t,i){return function(){return t.apply(i,arguments)}},r=function(t,i){function o(){this.constructor=t}for(var r in i)s.call(i,r)&&(t[r]=i[r]);return o.prototype=i.prototype,t.prototype=new o,t.__super__=i.prototype,t},s={}.hasOwnProperty;Morris.Bar=function(t){function i(t){if(this.onHoverOut=o(this.onHoverOut,this),this.onHoverMove=o(this.onHoverMove,this),this.onGridClick=o(this.onGridClick,this),!(this instanceof Morris.Bar))return new Morris.Bar(t);i.__super__.constructor.call(this,$.extend({},t,{parseTime:!1}))}return r(i,t),i.prototype.init=function(){if(this.cumulative=this.options.stacked,"always"!==this.options.hideHover)return this.hover=new Morris.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut),this.on("gridclick",this.onGridClick)},i.prototype.defaults={barSizeRatio:.75,barGap:3,barColors:["#0b62a4","#7a92a3","#4da74d","#afd8f8","#edc240","#cb4b4b","#9440ed"],barOpacity:1,barRadius:[0,0,0,0],xLabelMargin:50},i.prototype.calc=function(){var t;if(this.calcBars(),!1===this.options.hideHover)return(t=this.hover).update.apply(t,this.hoverContentForRow(this.data.length-1))},i.prototype.calcBars=function(){var t,i,o,r,s,n,h;for(s=[],t=i=0,o=(r=this.data).length;i<o;t=++i)(n=r[t])._x=this.left+this.width*(t+.5)/this.data.length,s.push(n._y=function(){var t,i,o,r;for(r=[],t=0,i=(o=n.y).length;t<i;t++)null!=(h=o[t])?r.push(this.transY(h)):r.push(null);return r}.call(this));return s},i.prototype.draw=function(){var t;return!0!==(t=this.options.axes)&&"both"!==t&&"x"!==t||this.drawXAxis(),this.drawSeries()},i.prototype.drawXAxis=function(){var t,i,o,r,s,n,h,a,e,l,p,u,c;for(c=this.bottom+(this.options.xAxisLabelTopPadding||this.options.padding/2),h=a=null,l=[],t=i=0,e=this.data.length;0<=e?i<e:e<i;t=0<=e?++i:--i)p=this.data[this.data.length-1-t],u=(o=this.drawXAxisLabel(p._x,c,p.label)).getBBox(),o.transform("r"+-this.options.xLabelAngle),r=o.getBBox(),o.transform("t0,"+r.height/2+"..."),0!==this.options.xLabelAngle&&(n=-.5*u.width*Math.cos(this.options.xLabelAngle*Math.PI/180),o.transform("t"+n+",0...")),(null==a||a>=r.x+r.width||null!=h&&h>=r.x)&&0<=r.x&&r.x+r.width<this.el.width()?(0!==this.options.xLabelAngle&&(s=1.25*this.options.gridTextSize/Math.sin(this.options.xLabelAngle*Math.PI/180),h=r.x-s),l.push(a=r.x-this.options.xLabelMargin)):l.push(o.remove());return l},i.prototype.drawSeries=function(){var s,n,h,a,e,l,p,t,u,c,d,i,f,v,b;return h=this.width/this.options.data.length,t=this.options.stacked?1:this.options.ykeys.length,s=(h*this.options.barSizeRatio-this.options.barGap*(t-1))/t,this.options.barSize&&(s=Math.min(s,this.options.barSize)),i=h-s*t-this.options.barGap*(t-1),p=i/2,b=this.ymin<=0&&0<=this.ymax?this.transY(0):null,this.bars=function(){var t,i,o,r;for(o=this.data,r=[],a=t=0,i=o.length;t<i;a=++t)u=o[a],e=0,r.push(function(){var t,i,o,r;for(o=u._y,r=[],c=t=0,i=o.length;t<i;c=++t)null!==(v=o[c])?(b?(f=Math.min(v,b),n=Math.max(v,b)):(f=v,n=this.bottom),l=this.left+a*h+p,this.options.stacked||(l+=c*(s+this.options.barGap)),d=n-f,this.options.verticalGridCondition&&this.options.verticalGridCondition(u.x)&&this.drawBar(this.left+a*h,this.top,h,Math.abs(this.top-this.bottom),this.options.verticalGridColor,this.options.verticalGridOpacity,this.options.barRadius),this.options.stacked&&(f-=e),this.drawBar(l,f,s,d,this.colorFor(u,c,"bar"),this.options.barOpacity,this.options.barRadius),r.push(e+=d)):r.push(null);return r}.call(this));return r}.call(this)},i.prototype.colorFor=function(t,i,o){var r,s;return"function"==typeof this.options.barColors?(r={x:t.x,y:t.y[i],label:t.label},s={index:i,key:this.options.ykeys[i],label:this.options.labels[i]},this.options.barColors.call(this,r,s,o)):this.options.barColors[i%this.options.barColors.length]},i.prototype.hitTest=function(t){return 0===this.data.length?null:(t=Math.max(Math.min(t,this.right),this.left),Math.min(this.data.length-1,Math.floor((t-this.left)/(this.width/this.data.length))))},i.prototype.onGridClick=function(t,i){var o;return o=this.hitTest(t),this.fire("click",o,this.data[o].src,t,i)},i.prototype.onHoverMove=function(t){var i,o;return i=this.hitTest(t),(o=this.hover).update.apply(o,this.hoverContentForRow(i))},i.prototype.onHoverOut=function(){if(!1!==this.options.hideHover)return this.hover.hide()},i.prototype.hoverContentForRow=function(t){var i,o,r,s,n,h,a;for(i="<div class='morris-hover-row-label'>"+(h=this.data[t]).label+"</div>",o=r=0,s=(n=h.y).length;r<s;o=++r)a=n[o],i+="<div class='morris-hover-point' style='color: "+this.colorFor(h,o,"label")+"'>\n  "+this.options.labels[o]+":\n  "+this.yLabelFormat(a)+"\n</div>";return"function"==typeof this.options.hoverCallback&&(i=this.options.hoverCallback(t,this.options,i,h.src)),[i,this.left+(t+.5)*this.width/this.data.length]},i.prototype.drawXAxisLabel=function(t,i,o){return this.raphael.text(t,i,o).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)},i.prototype.drawBar=function(t,i,o,r,s,n,h){var a;return(0===(a=Math.max.apply(Math,h))||r<a?this.raphael.rect(t,i,o,r):this.raphael.path(this.roundedRect(t,i,o,r,h))).attr("fill",s).attr("fill-opacity",n).attr("stroke","none")},i.prototype.roundedRect=function(t,i,o,r,s){return null==s&&(s=[0,0,0,0]),["M",t,s[0]+i,"Q",t,i,t+s[0],i,"L",t+o-s[1],i,"Q",t+o,i,t+o,i+s[1],"L",t+o,i+r-s[2],"Q",t+o,i+r,t+o-s[2],i+r,"L",t+s[3],i+r,"Q",t,i+r,t,i+r-s[3],"Z"]},i}(Morris.Grid)}).call(this);