(function(){var t=function(t,i){return function(){return t.apply(i,arguments)}},i=function(t,i){function r(){this.constructor=t}for(var s in i)o.call(i,s)&&(t[s]=i[s]);return r.prototype=i.prototype,t.prototype=new r,t.__super__=i.prototype,t},o={}.hasOwnProperty;Morris.Bar=function(o){function r(i){return this.onHoverOut=t(this.onHoverOut,this),this.onHoverMove=t(this.onHoverMove,this),this.onGridClick=t(this.onGridClick,this),this instanceof Morris.Bar?void r.__super__.constructor.call(this,$.extend({},i,{parseTime:!1})):new Morris.Bar(i)}return i(r,o),r.prototype.init=function(){return this.cumulative=this.options.stacked,"always"!==this.options.hideHover?(this.hover=new Morris.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut),this.on("gridclick",this.onGridClick)):void 0},r.prototype.defaults={barSizeRatio:.75,barGap:3,barColors:["#0b62a4","#7a92a3","#4da74d","#afd8f8","#edc240","#cb4b4b","#9440ed"],barOpacity:1,barRadius:[0,0,0,0],xLabelMargin:50},r.prototype.calc=function(){var t;return this.calcBars(),this.options.hideHover===!1?(t=this.hover).update.apply(t,this.hoverContentForRow(this.data.length-1)):void 0},r.prototype.calcBars=function(){var t,i,o,r,s,n,h;for(r=this.data,s=[],t=i=0,o=r.length;o>i;t=++i)n=r[t],n._x=this.left+this.width*(t+.5)/this.data.length,s.push(n._y=function(){var t,i,o,r;for(o=n.y,r=[],t=0,i=o.length;i>t;t++)h=o[t],null!=h?r.push(this.transY(h)):r.push(null);return r}.call(this));return s},r.prototype.draw=function(){var t;return(t=this.options.axes)!==!0&&"both"!==t&&"x"!==t||this.drawXAxis(),this.drawSeries()},r.prototype.drawXAxis=function(){var t,i,o,r,s,n,h,a,e,l,p,u,d;for(d=this.bottom+(this.options.xAxisLabelTopPadding||this.options.padding/2),a=null,h=null,l=[],t=i=0,e=this.data.length;e>=0?e>i:i>e;t=e>=0?++i:--i)p=this.data[this.data.length-1-t],o=this.drawXAxisLabel(p._x,d,p.label),u=o.getBBox(),o.transform("r"+-this.options.xLabelAngle),r=o.getBBox(),o.transform("t0,"+r.height/2+"..."),0!==this.options.xLabelAngle&&(n=-.5*u.width*Math.cos(this.options.xLabelAngle*Math.PI/180),o.transform("t"+n+",0...")),(null==a||a>=r.x+r.width||null!=h&&h>=r.x)&&r.x>=0&&r.x+r.width<this.el.width()?(0!==this.options.xLabelAngle&&(s=1.25*this.options.gridTextSize/Math.sin(this.options.xLabelAngle*Math.PI/180),h=r.x-s),l.push(a=r.x-this.options.xLabelMargin)):l.push(o.remove());return l},r.prototype.drawSeries=function(){var t,i,o,r,s,n,h,a,e,l,p,u,d,c,v;return o=this.width/this.options.data.length,a=this.options.stacked?1:this.options.ykeys.length,t=(o*this.options.barSizeRatio-this.options.barGap*(a-1))/a,this.options.barSize&&(t=Math.min(t,this.options.barSize)),u=o-t*a-this.options.barGap*(a-1),h=u/2,v=this.ymin<=0&&this.ymax>=0?this.transY(0):null,this.bars=function(){var a,u,f,b;for(f=this.data,b=[],r=a=0,u=f.length;u>a;r=++a)e=f[r],s=0,b.push(function(){var a,u,f,b;for(f=e._y,b=[],l=a=0,u=f.length;u>a;l=++a)c=f[l],null!==c?(v?(d=Math.min(c,v),i=Math.max(c,v)):(d=c,i=this.bottom),n=this.left+r*o+h,this.options.stacked||(n+=l*(t+this.options.barGap)),p=i-d,this.options.verticalGridCondition&&this.options.verticalGridCondition(e.x)&&this.drawBar(this.left+r*o,this.top,o,Math.abs(this.top-this.bottom),this.options.verticalGridColor,this.options.verticalGridOpacity,this.options.barRadius),this.options.stacked&&(d-=s),this.drawBar(n,d,t,p,this.colorFor(e,l,"bar"),this.options.barOpacity,this.options.barRadius),b.push(s+=p)):b.push(null);return b}.call(this));return b}.call(this)},r.prototype.colorFor=function(t,i,o){var r,s;return"function"==typeof this.options.barColors?(r={x:t.x,y:t.y[i],label:t.label},s={index:i,key:this.options.ykeys[i],label:this.options.labels[i]},this.options.barColors.call(this,r,s,o)):this.options.barColors[i%this.options.barColors.length]},r.prototype.hitTest=function(t){return 0===this.data.length?null:(t=Math.max(Math.min(t,this.right),this.left),Math.min(this.data.length-1,Math.floor((t-this.left)/(this.width/this.data.length))))},r.prototype.onGridClick=function(t,i){var o;return o=this.hitTest(t),this.fire("click",o,this.data[o].src,t,i)},r.prototype.onHoverMove=function(t){var i,o;return i=this.hitTest(t),(o=this.hover).update.apply(o,this.hoverContentForRow(i))},r.prototype.onHoverOut=function(){return this.options.hideHover!==!1?this.hover.hide():void 0},r.prototype.hoverContentForRow=function(t){var i,o,r,s,n,h,a,e;for(h=this.data[t],i="<div class='morris-hover-row-label'>"+h.label+"</div>",n=h.y,o=r=0,s=n.length;s>r;o=++r)e=n[o],i+="<div class='morris-hover-point' style='color: "+this.colorFor(h,o,"label")+"'>\n  "+this.options.labels[o]+":\n  "+this.yLabelFormat(e)+"\n</div>";return"function"==typeof this.options.hoverCallback&&(i=this.options.hoverCallback(t,this.options,i,h.src)),a=this.left+(t+.5)*this.width/this.data.length,[i,a]},r.prototype.drawXAxisLabel=function(t,i,o){var r;return r=this.raphael.text(t,i,o).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)},r.prototype.drawBar=function(t,i,o,r,s,n,h){var a,e;return a=Math.max.apply(Math,h),e=0===a||a>r?this.raphael.rect(t,i,o,r):this.raphael.path(this.roundedRect(t,i,o,r,h)),e.attr("fill",s).attr("fill-opacity",n).attr("stroke","none")},r.prototype.roundedRect=function(t,i,o,r,s){return null==s&&(s=[0,0,0,0]),["M",t,s[0]+i,"Q",t,i,t+s[0],i,"L",t+o-s[1],i,"Q",t+o,i,t+o,i+s[1],"L",t+o,i+r-s[2],"Q",t+o,i+r,t+o-s[2],i+r,"L",t+s[3],i+r,"Q",t,i+r,t,i+r-s[3],"Z"]},r}(Morris.Grid)}).call(this);