var gulp=require("gulp"),concat=require("gulp-concat"),uglify=require("gulp-uglify"),util=require("gulp-util"),jshint=require("gulp-jshint"),size=require("gulp-size"),connect=require("gulp-connect"),replace=require("gulp-replace"),htmlv=require("gulp-html-validator"),inquirer=require("inquirer"),semver=require("semver"),exec=require("child_process").exec,fs=require("fs"),package=require("./package.json"),bower=require("./bower.json"),srcDir="./src/";gulp.task("build",function(){function r(e){return srcDir+"Chart."+e+".js"}var i=[r("Core")],e=!!util.env.types,s=e?"custom":".";return e?util.env.types.split(",").forEach(function(e){return i.push(r(e))}):i.push(srcDir+"*"),gulp.src(i).pipe(concat("Chart.js")).pipe(replace("{{ version }}",package.version)).pipe(gulp.dest(s)).pipe(uglify({preserveComments:"some"})).pipe(concat("Chart.min.js")).pipe(gulp.dest(s))}),gulp.task("bump",function(s){util.log("Current version:",util.colors.cyan(package.version));var e=["major","premajor","minor","preminor","patch","prepatch","prerelease"].map(function(e){return e+" (v"+semver.inc(package.version,e)+")"});inquirer.prompt({type:"list",name:"version",message:"What version update would you like?",choices:e},function(e){var r=e.version.split(" ")[0],i=semver.inc(package.version,r);package.version=i,bower.version=i,fs.writeFileSync("package.json",JSON.stringify(package,null,2)),fs.writeFileSync("bower.json",JSON.stringify(bower,null,2)),s()})}),gulp.task("release",["build"],function(){exec("git tag -a v"+package.version)}),gulp.task("jshint",function(){return gulp.src(srcDir+"*.js").pipe(jshint()).pipe(jshint.reporter("default"))}),gulp.task("valid",function(){return gulp.src("samples/*.html").pipe(htmlv())}),gulp.task("library-size",function(){return gulp.src("Chart.min.js").pipe(size({gzip:!0}))}),gulp.task("module-sizes",function(){return gulp.src(srcDir+"*.js").pipe(uglify({preserveComments:"some"})).pipe(size({showFiles:!0,gzip:!0}))}),gulp.task("watch",function(){gulp.watch("./src/*",["build"])}),gulp.task("test",["jshint","valid"]),gulp.task("size",["library-size","module-sizes"]),gulp.task("default",["build","watch"]),gulp.task("server",function(){connect.server({port:8e3})}),gulp.task("_open",function(){exec("open http://localhost:8000"),exec("subl .")}),gulp.task("dev",["server","default"]);