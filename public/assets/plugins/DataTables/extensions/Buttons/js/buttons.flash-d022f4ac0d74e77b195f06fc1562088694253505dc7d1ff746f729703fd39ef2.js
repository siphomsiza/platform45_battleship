!function(t,e){"use strict";var i={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(t){return"string"==typeof t&&(t=document.getElementById(t)),t.addClass||(t.hide=function(){this.style.display="none"},t.show=function(){this.style.display=""},t.addClass=function(t){this.removeClass(t),this.className+=" "+t},t.removeClass=function(t){this.className=this.className.replace(new RegExp("\\s*"+t+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},t.hasClass=function(t){return!!this.className.match(new RegExp("\\s*"+t+"\\s*"))}),t},setMoviePath:function(t){this.moviePath=t},dispatch:function(t,e,i){var s=this.clients[t];s&&s.receiveEvent(e,i)},register:function(t,e){this.clients[t]=e},getDOMObjectPosition:function(t){var e={left:0,top:0,width:t.width?t.width:t.offsetWidth,height:t.height?t.height:t.offsetHeight};for(""!==t.style.width&&(e.width=t.style.width.replace("px","")),""!==t.style.height&&(e.height=t.style.height.replace("px",""));t;)e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;return e},Client:function(t){this.handlers={},this.id=i.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,i.register(this.id,this),t&&this.glue(t)}};i.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(t,e){this.domElement=i.$(t);var s=99;this.domElement.style.zIndex&&(s=parseInt(this.domElement.style.zIndex,10)+1);var n=i.getDOMObjectPosition(this.domElement);this.div=document.createElement("div");var o=this.div.style;o.position="absolute",o.left="0px",o.top="0px",o.width=n.width+"px",o.height=n.height+"px",o.zIndex=s,"undefined"!=typeof e&&""!==e&&(this.div.title=e),0!==n.width&&0!==n.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(n.width,n.height).replace(/&/g,"&amp;"))},positionElement:function(){var t=i.getDOMObjectPosition(this.domElement),e=this.div.style;if(e.position="absolute",e.width=t.width+"px",e.height=t.height+"px",0!==t.width&&0!==t.height){this.sized=!0;var s=this.div.childNodes[0];s.width=t.width,s.height=t.height}},getHTML:function(t,e){var s="",n="id="+this.id+"&width="+t+"&height="+e;if(navigator.userAgent.match(/MSIE/)){var o=location.href.match(/^https/i)?"https://":"http://";s+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+o+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+t+'" height="'+e+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+i.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+n+'"/><param name="wmode" value="transparent"/></object>'}else s+='<embed id="'+this.movieId+'" src="'+i.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+t+'" height="'+e+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+n+'" wmode="transparent" />';return s},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){var e=this;this.domElement&&this.div&&(t(this.div).remove(),this.domElement=null,this.div=null,t.each(i.clients,function(t,s){s===e&&delete i.clients[t]}))},reposition:function(t){if(t&&(this.domElement=i.$(t),this.domElement||this.hide()),this.domElement&&this.div){var e=i.getDOMObjectPosition(this.domElement),s=this.div.style;s.left=""+e.left+"px",s.top=""+e.top+"px"}},clearText:function(){this.clipText="",this.ready&&this.movie.clearText()},appendText:function(t){this.clipText+=t,this.ready&&this.movie.appendText(t)},setText:function(t){this.clipText=t,this.ready&&this.movie.setText(t)},setFileName:function(t){this.fileName=t,this.ready&&this.movie.setFileName(t)},setAction:function(t){this.action=t,this.ready&&this.movie.setAction(t)},addEventListener:function(t,e){t=t.toString().toLowerCase().replace(/^on/,""),this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)},setHandCursor:function(t){this.handCursorEnabled=t,this.ready&&this.movie.setHandCursor(t)},setCSSEffects:function(t){this.cssEffects=!!t},receiveEvent:function(t,e){var i;switch(t=t.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=document.getElementById(this.movieId),!this.movie)return i=this,void setTimeout(function(){i.receiveEvent("load",null)},1);if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/))return i=this,setTimeout(function(){i.receiveEvent("load",null)},100),void(this.ready=!0);this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[t])for(var s=0,n=this.handlers[t].length;n>s;s++){var o=this.handlers[t][s];"function"==typeof o?o(this,e):"object"==typeof o&&2==o.length?o[0][o[1]](this,e):"string"==typeof o&&window[o](this,e)}}},i.hasFlash=function(){try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(t)return!0}catch(e){if(navigator.mimeTypes&&void 0!==navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},window.ZeroClipboard_TableTools=i;var s=function(t,e){e.attr("id");e.parents("html").length?t.glue(e[0],""):setTimeout(function(){s(t,e)},500)},n=function(e,i){var s=e.title;return-1!==s.indexOf("*")&&(s=s.replace("*",t("title").text())),s=s.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),void 0===i||i===!0?s+e.extension:s},o=function(t,e){var i=e.match(/[\s\S]{1,8192}/g)||[];t.clearText();for(var s=0,n=i.length;n>s;s++)t.appendText(i[s])},a=function(t){return t.newline?t.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},r=function(t,e){for(var i=a(e),s=t.buttons.exportData(e.exportOptions),n=function(t){return e.fieldBoundary+t.join(e.fieldBoundary+e.fieldSeparator+e.fieldBoundary)+e.fieldBoundary},o=e.header?n(s.header)+i:"",r=e.footer?i+n(s.footer):"",h=[],l=0,d=s.body.length;d>l;l++)h.push(n(s.body[l]));return{str:o+h.join(i)+r,rows:h.length}},h={available:function(){return i.hasFlash()},init:function(t,n,o){i.moviePath=e.Buttons.swfPath;var a=new i.Client;a.setHandCursor(!0),a.addEventListener("mouseDown",function(){o._fromFlash=!0,t.button(n[0]).trigger(),o._fromFlash=!1}),s(a,n),o._flash=a},destroy:function(t,e,i){i._flash.destroy()},fieldSeparator:",",fieldBoundary:'"',exportOptions:{},title:"*",extension:".csv",header:!0,footer:!1};e.Buttons.swfPath="//cdn.datatables.net/buttons/1.0.0/swf/flashExport.swf",e.Api.register("buttons.resize()",function(){t.each(i.clients,function(t,e){void 0!==e.domElement&&e.domElement.parentNode&&e.positionElement()})}),e.ext.buttons.copyFlash=t.extend({},h,{className:"buttons-copy buttons-flash",text:function(t){return t.i18n("buttons.copy","Copy")},action:function(t,e,i,s){if(s._fromFlash){var n=s._flash,a=r(e,s);n.setAction("copy"),o(n,a.str),e.buttons.info(e.i18n("buttons.copyTitle","Copy to clipboard"),e.i18n("buttons.copyInfo",{_:"Copied %d rows to clipboard",1:"Copied 1 row to clipboard"},a.rows),3e3)}},fieldSeparator:"	",fieldBoundary:""}),e.ext.buttons.csvFlash=t.extend({},h,{className:"buttons-csv buttons-flash",text:function(t){return t.i18n("buttons.csv","CSV")},action:function(t,e,i,s){var a=s._flash,h=r(e,s);a.setAction("csv"),a.setFileName(n(s)),o(a,h.str)}}),e.ext.buttons.excelFlash=t.extend({},h,{className:"buttons-excel buttons-flash",text:function(t){return t.i18n("buttons.excel","Excel")},action:function(e,i,s,a){var r="",h=a._flash,l=i.buttons.exportData(a.exportOptions),d=function(e){for(var i=[],s=0,n=e.length;n>s;s++)i.push(t.isNumeric(e[s])?'<c t="n"><v>'+e[s]+"</v></c>":'<c t="inlineStr"><is><t>'+e[s]+"</t></is></c>");return"<row>"+i.join("")+"</row>"};a.header&&(r+=d(l.header));for(var c=0,f=l.body.length;f>c;c++)r+=d(l.body[c]);a.header&&(r+=d(l.footer)),h.setAction("excel"),h.setFileName(n(a)),o(h,r)},extension:".xlsx"}),e.ext.buttons.pdfFlash=t.extend({},h,{className:"buttons-pdf buttons-flash",text:function(t){return t.i18n("buttons.pdf","PDF")},action:function(t,e,i,s){var a=s._flash,r=e.buttons.exportData(s.exportOptions),h=e.table().node().offsetWidth,l=e.columns(s.columns).indexes().map(function(t){return e.column(t).header().offsetWidth/h});a.setAction("pdf"),a.setFileName(n(s)),o(a,JSON.stringify({title:n(s,!1),message:s.message,colWidth:l.toArray(),orientation:s.orientation,size:s.pageSize,header:s.header?r.header:null,footer:s.footer?r.footer:null,body:r.body}))},extension:".pdf",orientation:"portrait",pageSize:"A4",message:"",newline:"\n"})}(jQuery,jQuery.fn.dataTable);