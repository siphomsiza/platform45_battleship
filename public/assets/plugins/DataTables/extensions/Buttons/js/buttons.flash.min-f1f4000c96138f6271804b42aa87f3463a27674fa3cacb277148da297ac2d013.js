!function(h,o){var n={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(t){return"string"==typeof t&&(t=document.getElementById(t)),t.addClass||(t.hide=function(){this.style.display="none"},t.show=function(){this.style.display=""},t.addClass=function(t){this.removeClass(t),this.className+=" "+t},t.removeClass=function(t){this.className=this.className.replace(RegExp("\\s*"+t+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},t.hasClass=function(t){return!!this.className.match(RegExp("\\s*"+t+"\\s*"))}),t},setMoviePath:function(t){this.moviePath=t},dispatch:function(t,e,i){(t=this.clients[t])&&t.receiveEvent(e,i)},register:function(t,e){this.clients[t]=e},getDOMObjectPosition:function(t){var e={left:0,top:0,width:t.width?t.width:t.offsetWidth,height:t.height?t.height:t.offsetHeight};for(""!==t.style.width&&(e.width=t.style.width.replace("px","")),""!==t.style.height&&(e.height=t.style.height.replace("px",""));t;)e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;return e},Client:function(t){this.handlers={},this.id=n.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,n.register(this.id,this),t&&this.glue(t)}};n.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(t,e){this.domElement=n.$(t);var i=99;this.domElement.style.zIndex&&(i=parseInt(this.domElement.style.zIndex,10)+1);var s=n.getDOMObjectPosition(this.domElement);this.div=document.createElement("div");var o=this.div.style;o.position="absolute",o.left="0px",o.top="0px",o.width=s.width+"px",o.height=s.height+"px",o.zIndex=i,void 0!==e&&""!==e&&(this.div.title=e),0!==s.width&&0!==s.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(s.width,s.height).replace(/&/g,"&amp;"))},positionElement:function(){var t=n.getDOMObjectPosition(this.domElement),e=this.div.style;e.position="absolute",e.width=t.width+"px",e.height=t.height+"px",0!==t.width&&0!==t.height&&(this.sized=!0,(e=this.div.childNodes[0]).width=t.width,e.height=t.height)},getHTML:function(t,e){var i="",s="id="+this.id+"&width="+t+"&height="+e;if(navigator.userAgent.match(/MSIE/))i=i+'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+(location.href.match(/^https/i)?"https://":"http://")+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+t+'" height="'+e+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+n.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+s+'"/><param name="wmode" value="transparent"/></object>';else i+='<embed id="'+this.movieId+'" src="'+n.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+t+'" height="'+e+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+s+'" wmode="transparent" />';return i},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){var i=this;this.domElement&&this.div&&(h(this.div).remove(),this.div=this.domElement=null,h.each(n.clients,function(t,e){e===i&&delete n.clients[t]}))},reposition:function(t){if(t&&((this.domElement=n.$(t))||this.hide()),this.domElement&&this.div){t=n.getDOMObjectPosition(this.domElement);var e=this.div.style;e.left=t.left+"px",e.top=t.top+"px"}},clearText:function(){this.clipText="",this.ready&&this.movie.clearText()},appendText:function(t){this.clipText+=t,this.ready&&this.movie.appendText(t)},setText:function(t){this.clipText=t,this.ready&&this.movie.setText(t)},setFileName:function(t){this.fileName=t,this.ready&&this.movie.setFileName(t)},setAction:function(t){this.action=t,this.ready&&this.movie.setAction(t)},addEventListener:function(t,e){t=t.toString().toLowerCase().replace(/^on/,""),this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)},setHandCursor:function(t){this.handCursorEnabled=t,this.ready&&this.movie.setHandCursor(t)},setCSSEffects:function(t){this.cssEffects=!!t},receiveEvent:function(t,e){var i;switch(t=t.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=document.getElementById(this.movieId),!this.movie)return i=this,void setTimeout(function(){i.receiveEvent("load",null)},1);if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/))return i=this,setTimeout(function(){i.receiveEvent("load",null)},100),void(this.ready=!0);this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[t])for(var s=0,o=this.handlers[t].length;s<o;s++){var n=this.handlers[t][s];"function"==typeof n?n(this,e):"object"==typeof n&&2==n.length?n[0][n[1]](this,e):"string"==typeof n&&window[n](this,e)}}},n.hasFlash=function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(t){if(navigator.mimeTypes&&void 0!==navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},window.ZeroClipboard_TableTools=n;var a=function(t,e){e.attr("id"),e.parents("html").length?t.glue(e[0],""):setTimeout(function(){a(t,e)},500)},l=function(t,e){var i=t.title;return-1!==i.indexOf("*")&&(i=i.replace("*",h("title").text())),i=i.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),void 0===e||!0===e?i+t.extension:i},r=function(t,e){var i=e.match(/[\s\S]{1,8192}/g)||[];t.clearText();for(var s=0,o=i.length;s<o;s++)t.appendText(i[s])},d=function(t,e){for(var i=e.newline?e.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n",s=t.buttons.exportData(e.exportOptions),o=function(t){return e.fieldBoundary+t.join(e.fieldBoundary+e.fieldSeparator+e.fieldBoundary)+e.fieldBoundary},n=e.header?o(s.header)+i:"",a=e.footer?i+o(s.footer):"",h=[],l=0,r=s.body.length;l<r;l++)h.push(o(s.body[l]));return{str:n+h.join(i)+a,rows:h.length}},t={available:function(){return n.hasFlash()},init:function(t,e,i){n.moviePath=o.Buttons.swfPath;var s=new n.Client;s.setHandCursor(!0),s.addEventListener("mouseDown",function(){i._fromFlash=!0,t.button(e[0]).trigger(),i._fromFlash=!1}),a(s,e),i._flash=s},destroy:function(t,e,i){i._flash.destroy()},fieldSeparator:",",fieldBoundary:'"',exportOptions:{},title:"*",extension:".csv",header:!0,footer:!1};o.Buttons.swfPath="//cdn.datatables.net/buttons/1.0.0/swf/flashExport.swf",o.Api.register("buttons.resize()",function(){h.each(n.clients,function(t,e){void 0!==e.domElement&&e.domElement.parentNode&&e.positionElement()})}),o.ext.buttons.copyFlash=h.extend({},t,{className:"buttons-copy buttons-flash",text:function(t){return t.i18n("buttons.copy","Copy")},action:function(t,e,i,s){s._fromFlash&&(t=s._flash,s=d(e,s),t.setAction("copy"),r(t,s.str),e.buttons.info(e.i18n("buttons.copyTitle","Copy to clipboard"),e.i18n("buttons.copyInfo",{_:"Copied %d rows to clipboard",1:"Copied 1 row to clipboard"},s.rows),3e3))},fieldSeparator:"\t",fieldBoundary:""}),o.ext.buttons.csvFlash=h.extend({},t,{className:"buttons-csv buttons-flash",text:function(t){return t.i18n("buttons.csv","CSV")},action:function(t,e,i,s){t=s._flash,e=d(e,s),t.setAction("csv"),t.setFileName(l(s)),r(t,e.str)}}),o.ext.buttons.excelFlash=h.extend({},t,{className:"buttons-excel buttons-flash",text:function(t){return t.i18n("buttons.excel","Excel")},action:function(t,e,i,s){t="",i=s._flash,e=e.buttons.exportData(s.exportOptions);var o=function(t){for(var e=[],i=0,s=t.length;i<s;i++)e.push(h.isNumeric(t[i])?'<c t="n"><v>'+t[i]+"</v></c>":'<c t="inlineStr"><is><t>'+t[i]+"</t></is></c>");return"<row>"+e.join("")+"</row>"};s.header&&(t+=o(e.header));for(var n=0,a=e.body.length;n<a;n++)t+=o(e.body[n]);s.header&&(t+=o(e.footer)),i.setAction("excel"),i.setFileName(l(s)),r(i,t)},extension:".xlsx"}),o.ext.buttons.pdfFlash=h.extend({},t,{className:"buttons-pdf buttons-flash",text:function(t){return t.i18n("buttons.pdf","PDF")},action:function(t,e,i,s){t=s._flash,i=e.buttons.exportData(s.exportOptions);var o=e.table().node().offsetWidth,n=e.columns(s.columns).indexes().map(function(t){return e.column(t).header().offsetWidth/o});t.setAction("pdf"),t.setFileName(l(s)),r(t,JSON.stringify({title:l(s,!1),message:s.message,colWidth:n.toArray(),orientation:s.orientation,size:s.pageSize,header:s.header?i.header:null,footer:s.footer?i.footer:null,body:i.body}))},extension:".pdf",orientation:"portrait",pageSize:"A4",message:"",newline:"\n"})}(jQuery,jQuery.fn.dataTable);