!function(d,n){"use strict";var o={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(t){return"string"==typeof t&&(t=document.getElementById(t)),t.addClass||(t.hide=function(){this.style.display="none"},t.show=function(){this.style.display=""},t.addClass=function(t){this.removeClass(t),this.className+=" "+t},t.removeClass=function(t){this.className=this.className.replace(new RegExp("\\s*"+t+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},t.hasClass=function(t){return!!this.className.match(new RegExp("\\s*"+t+"\\s*"))}),t},setMoviePath:function(t){this.moviePath=t},dispatch:function(t,e,i){var s=this.clients[t];s&&s.receiveEvent(e,i)},register:function(t,e){this.clients[t]=e},getDOMObjectPosition:function(t){var e={left:0,top:0,width:t.width?t.width:t.offsetWidth,height:t.height?t.height:t.offsetHeight};for(""!==t.style.width&&(e.width=t.style.width.replace("px","")),""!==t.style.height&&(e.height=t.style.height.replace("px",""));t;)e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;return e},Client:function(t){this.handlers={},this.id=o.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,o.register(this.id,this),t&&this.glue(t)}};o.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(t,e){this.domElement=o.$(t);var i=99;this.domElement.style.zIndex&&(i=parseInt(this.domElement.style.zIndex,10)+1);var s=o.getDOMObjectPosition(this.domElement);this.div=document.createElement("div");var n=this.div.style;n.position="absolute",n.left="0px",n.top="0px",n.width=s.width+"px",n.height=s.height+"px",n.zIndex=i,void 0!==e&&""!==e&&(this.div.title=e),0!==s.width&&0!==s.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(s.width,s.height).replace(/&/g,"&amp;"))},positionElement:function(){var t=o.getDOMObjectPosition(this.domElement),e=this.div.style;if(e.position="absolute",e.width=t.width+"px",e.height=t.height+"px",0!==t.width&&0!==t.height){this.sized=!0;var i=this.div.childNodes[0];i.width=t.width,i.height=t.height}},getHTML:function(t,e){var i="",s="id="+this.id+"&width="+t+"&height="+e;navigator.userAgent.match(/MSIE/)?i+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+(location.href.match(/^https/i)?"https://":"http://")+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+t+'" height="'+e+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+o.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+s+'"/><param name="wmode" value="transparent"/></object>':i+='<embed id="'+this.movieId+'" src="'+o.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+t+'" height="'+e+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+s+'" wmode="transparent" />';return i},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){var i=this;this.domElement&&this.div&&(d(this.div).remove(),this.domElement=null,this.div=null,d.each(o.clients,function(t,e){e===i&&delete o.clients[t]}))},reposition:function(t){if(t&&(this.domElement=o.$(t),this.domElement||this.hide()),this.domElement&&this.div){var e=o.getDOMObjectPosition(this.domElement),i=this.div.style;i.left=e.left+"px",i.top=e.top+"px"}},clearText:function(){this.clipText="",this.ready&&this.movie.clearText()},appendText:function(t){this.clipText+=t,this.ready&&this.movie.appendText(t)},setText:function(t){this.clipText=t,this.ready&&this.movie.setText(t)},setFileName:function(t){this.fileName=t,this.ready&&this.movie.setFileName(t)},setAction:function(t){this.action=t,this.ready&&this.movie.setAction(t)},addEventListener:function(t,e){t=t.toString().toLowerCase().replace(/^on/,""),this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)},setHandCursor:function(t){this.handCursorEnabled=t,this.ready&&this.movie.setHandCursor(t)},setCSSEffects:function(t){this.cssEffects=!!t},receiveEvent:function(t,e){var i;switch(t=t.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=document.getElementById(this.movieId),!this.movie)return i=this,void setTimeout(function(){i.receiveEvent("load",null)},1);if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/))return i=this,setTimeout(function(){i.receiveEvent("load",null)},100),void(this.ready=!0);this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[t])for(var s=0,n=this.handlers[t].length;s<n;s++){var o=this.handlers[t][s];"function"==typeof o?o(this,e):"object"==typeof o&&2==o.length?o[0][o[1]](this,e):"string"==typeof o&&window[o](this,e)}}},o.hasFlash=function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(t){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==undefined&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},window.ZeroClipboard_TableTools=o;var a=function(t,e){e.attr("id");e.parents("html").length?t.glue(e[0],""):setTimeout(function(){a(t,e)},500)},c=function(t,e){var i=t.title;return-1!==i.indexOf("*")&&(i=i.replace("*",d("title").text())),i=i.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),e===undefined||!0===e?i+t.extension:i},f=function(t,e){var i=e.match(/[\s\S]{1,8192}/g)||[];t.clearText();for(var s=0,n=i.length;s<n;s++)t.appendText(i[s])},u=function(t){return t.newline?t.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},r=function(t,e){for(var i=u(e),s=t.buttons.exportData(e.exportOptions),n=function(t){return e.fieldBoundary+t.join(e.fieldBoundary+e.fieldSeparator+e.fieldBoundary)+e.fieldBoundary},o=e.header?n(s.header)+i:"",a=e.footer?i+n(s.footer):"",r=[],h=0,l=s.body.length;h<l;h++)r.push(n(s.body[h]));return{str:o+r.join(i)+a,rows:r.length}},t={available:function(){return o.hasFlash()},init:function(t,e,i){o.moviePath=n.Buttons.swfPath;var s=new o.Client;s.setHandCursor(!0),s.addEventListener("mouseDown",function(){i._fromFlash=!0,t.button(e[0]).trigger(),i._fromFlash=!1}),a(s,e),i._flash=s},destroy:function(t,e,i){i._flash.destroy()},fieldSeparator:",",fieldBoundary:'"',exportOptions:{},title:"*",extension:".csv",header:!0,footer:!1};n.Buttons.swfPath="//cdn.datatables.net/buttons/1.0.0/swf/flashExport.swf",n.Api.register("buttons.resize()",function(){d.each(o.clients,function(t,e){e.domElement!==undefined&&e.domElement.parentNode&&e.positionElement()})}),n.ext.buttons.copyFlash=d.extend({},t,{className:"buttons-copy buttons-flash",text:function(t){return t.i18n("buttons.copy","Copy")},action:function(t,e,i,s){if(s._fromFlash){var n=s._flash,o=r(e,s);n.setAction("copy"),f(n,o.str),e.buttons.info(e.i18n("buttons.copyTitle","Copy to clipboard"),e.i18n("buttons.copyInfo",{_:"Copied %d rows to clipboard",1:"Copied 1 row to clipboard"},o.rows),3e3)}},fieldSeparator:"\t",fieldBoundary:""}),n.ext.buttons.csvFlash=d.extend({},t,{className:"buttons-csv buttons-flash",text:function(t){return t.i18n("buttons.csv","CSV")},action:function(t,e,i,s){var n=s._flash,o=r(e,s);n.setAction("csv"),n.setFileName(c(s)),f(n,o.str)}}),n.ext.buttons.excelFlash=d.extend({},t,{className:"buttons-excel buttons-flash",text:function(t){return t.i18n("buttons.excel","Excel")},action:function(t,e,i,s){var n="",o=s._flash,a=e.buttons.exportData(s.exportOptions),r=function(t){for(var e=[],i=0,s=t.length;i<s;i++)e.push(d.isNumeric(t[i])?'<c t="n"><v>'+t[i]+"</v></c>":'<c t="inlineStr"><is><t>'+t[i]+"</t></is></c>");return"<row>"+e.join("")+"</row>"};s.header&&(n+=r(a.header));for(var h=0,l=a.body.length;h<l;h++)n+=r(a.body[h]);s.header&&(n+=r(a.footer)),o.setAction("excel"),o.setFileName(c(s)),f(o,n)},extension:".xlsx"}),n.ext.buttons.pdfFlash=d.extend({},t,{className:"buttons-pdf buttons-flash",text:function(t){return t.i18n("buttons.pdf","PDF")},action:function(t,e,i,s){var n=s._flash,o=e.buttons.exportData(s.exportOptions),a=e.table().node().offsetWidth,r=e.columns(s.columns).indexes().map(function(t){return e.column(t).header().offsetWidth/a});n.setAction("pdf"),n.setFileName(c(s)),f(n,JSON.stringify({title:c(s,!1),message:s.message,colWidth:r.toArray(),orientation:s.orientation,size:s.pageSize,header:s.header?o.header:null,footer:s.footer?o.footer:null,body:o.body}))},extension:".pdf",orientation:"portrait",pageSize:"A4",message:"",newline:"\n"})}(jQuery,jQuery.fn.dataTable);