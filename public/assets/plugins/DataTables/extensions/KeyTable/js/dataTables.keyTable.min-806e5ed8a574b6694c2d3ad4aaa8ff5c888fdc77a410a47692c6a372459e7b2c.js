!function(r,c,s){var e=function(o,n){var l=function(e,t){if(!n.versionCheck||!n.versionCheck("1.10.8"))throw"KeyTable requires DataTables 1.10.8 or newer";this.c=o.extend(!0,{},n.defaults.keyTable,l.defaults,t),this.s={dt:new n.Api(e),enable:!0},this.dom={};var s=this.s.dt.settings()[0],i=s.keytable;if(i)return i;(s.keytable=this)._constructor()};return l.prototype={blur:function(){this._blur()},enable:function(e){this.s.enable=e},focus:function(e,t){this._focus(this.s.dt.cell(e,t))},_constructor:function(){this._tabInput();var l=this,t=this.s.dt,e=o(t.table().node());"static"===e.css("position")&&e.css("position","relative"),o(t.table().body()).on("click.keyTable","th, td",function(){if(!1!==l.s.enable){var e=t.cell(this);e.any()&&l._focus(e)}}),o(c.body).on("keydown.keyTable",function(e){l._key(e)}),this.c.blurable&&o(c.body).on("click.keyTable",function(e){o(e.target).parents(".dataTables_filter").length&&l._blur(),o(e.target).parents().filter(t.table().container()).length||o(e.target).parents("div.DTE").length||l._blur()}),this.c.editor&&t.on("key.kt",function(e,t,s,i,n){l._editor(s,n)}),t.settings()[0].oFeatures.bStateSave&&t.on("stateSaveParams.keyTable",function(e,t,s){s.keyTable=l.s.lastFocus?l.s.lastFocus.index():null}),t.on("destroy.keyTable",function(){t.off(".keyTable"),o(t.table().body()).off("click.keyTable","th, td"),o(c.body).off("keydown.keyTable").off("click.keyTable")}),(e=t.state.loaded())&&e.keyTable?t.cell(e.keyTable).focus():this.c.focus&&t.cell(this.c.focus).focus()},_blur:function(){if(this.s.enable&&this.s.lastFocus){var e=this.s.lastFocus;o(e.node()).removeClass(this.c.className),this.s.lastFocus=null,this._emitEvent("key-blur",[this.s.dt,e])}},_columns:function(){var e=this.s.dt,t=e.columns(this.c.columns).indexes(),s=[];return e.columns(":visible").every(function(e){-1!==t.indexOf(e)&&s.push(e)}),s},_editor:function(e,t){var s=this.s.dt,i=this.c.editor;t.stopPropagation(),i.inline(this.s.lastFocus.index());var n=o("div.DTE input");n.length&&n[0].select(),s.keys.enable("navigation-only"),s.one("key-blur.editor",function(){i.displayed()&&i.submit()}),i.one("close",function(){s.keys.enable(!0),s.off("key-blur.editor")})},_emitEvent:function(t,s){this.s.dt.iterator("table",function(e){o(e.nTable).triggerHandler(t,s)})},_focus:function(e,t){var s=this,i=this.s.dt,n=i.page.info(),l=this.s.lastFocus;if(this.s.enable){if("number"!=typeof e){var a=e.index();t=a.column,e=i.rows({filter:"applied",order:"applied"}).indexes().indexOf(a.row);n.serverSide&&(e+=n.start)}if(e<n.start||e>=n.start+n.length)i.one("draw",function(){s._focus(e,t)}).page(Math.floor(e/n.length)).draw(!1);else if(-1!==o.inArray(t,this._columns())){if(n.serverSide&&(e-=n.start),n=i.cell(":eq("+e+")",t),l){if(l.node()===n.node())return;this._blur()}(l=o(n.node())).addClass(this.c.className),this._scroll(o(r),o(c.body),l,"offset"),(a=i.table().body().parentNode)!==i.table().header().parentNode&&(a=o(a.parentNode),this._scroll(a,a,l,"position")),this.s.lastFocus=n,this._emitEvent("key-focus",[this.s.dt,n]),i.state.save()}}},_key:function(e){if(this.s.enable&&!(0===e.keyCode||e.ctrlKey||e.metaKey||e.altKey)){var t=this.s.lastFocus;if(t){var s=this,i=this.s.dt;if(!this.c.keys||-1!==o.inArray(e.keyCode,this.c.keys))switch(e.keyCode){case 9:this._shift(e,e.shiftKey?"left":"right",!0);break;case 27:this.s.blurable&&!0===this.s.enable&&this._blur();break;case 33:case 34:e.preventDefault();var n=i.cells({page:"current"}).nodes().indexOf(t.node());i.one("draw",function(){var e=i.cells({page:"current"}).nodes();s._focus(i.cell(n<e.length?e[n]:e[e.length-1]))}).page(33===e.keyCode?"previous":"next").draw(!1);break;case 35:case 36:e.preventDefault(),t=i.cells({page:"current"}).indexes(),this._focus(i.cell(t[35===e.keyCode?t.length-1:0]));break;case 37:this._shift(e,"left");break;case 38:this._shift(e,"up");break;case 39:this._shift(e,"right");break;case 40:this._shift(e,"down");break;default:!0===this.s.enable&&this._emitEvent("key",[i,e.keyCode,this.s.lastFocus,e])}}}},_scroll:function(e,t,s,i){i=s[i]();var n=s.outerHeight(),l=(s=s.outerWidth(),t.scrollTop()),a=t.scrollLeft(),o=e.height();e=e.width();i.top<l&&t.scrollTop(i.top),i.left<a&&t.scrollLeft(i.left),i.top+n>l+o&&t.scrollTop(i.top+n-o),i.left+s>a+e&&t.scrollLeft(i.left+s-e)},_shift:function(e,t,s){var i=this.s.dt,n=i.page.info(),l=n.recordsDisplay,a=this.s.lastFocus,o=this._columns();if(a){var r=i.rows({filter:"applied",order:"applied"}).indexes().indexOf(a.index().row);n.serverSide&&(r+=n.start),n=o[i=i.columns(o).indexes().indexOf(a.index().column)],"right"===t?i>=o.length-1?(r++,n=o[0]):n=o[i+1]:"left"===t?0===i?(r--,n=o[o.length-1]):n=o[i-1]:"up"===t?r--:"down"===t&&r++,0<=r&&r<l&&0<=n&&n<=o.length?(e.preventDefault(),this._focus(r,n)):s&&this.c.blurable?this._blur():e.preventDefault()}},_tabInput:function(){var e=this,t=this.s.dt,s=null!==this.c.tabIndex?this.c.tabIndex:t.settings()[0].iTabIndex;-1!=s&&o('<div><input type="text" tabindex="'+s+'"/></div>').css({position:"absolute",height:1,width:0,overflow:"hidden"}).insertBefore(t.table().node()).children().on("focus",function(){e._focus(t.cell(":eq(0)",{page:"current"}))})}},l.defaults={blurable:!0,className:"focus",columns:"",editor:null,focus:null,keys:null,tabIndex:null},l.version="2.0.0",o.fn.dataTable.KeyTable=l,o.fn.DataTable.KeyTable=l,n.Api.register("cell.blur()",function(){return this.iterator("table",function(e){e.keytable&&e.keytable.blur()})}),n.Api.register("cell().focus()",function(){return this.iterator("cell",function(e,t,s){e.keytable&&e.keytable.focus(t,s)})}),n.Api.register("keys.disable()",function(){return this.iterator("table",function(e){e.keytable&&e.keytable.enable(!1)})}),n.Api.register("keys.enable()",function(t){return this.iterator("table",function(e){e.keytable&&e.keytable.enable(t===s||t)})}),o(c).on("preInit.dt.dtk",function(e,t){if("dt"===e.namespace){var s=t.oInit.keys,i=n.defaults.keys;(s||i)&&(i=o.extend({},s,i),!1!==s&&new l(t,i))}}),l};"function"==typeof define&&define.amd?define(["jquery","datatables"],e):"object"==typeof exports?e(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.KeyTable&&e(jQuery,jQuery.fn.dataTable)}(window,document);