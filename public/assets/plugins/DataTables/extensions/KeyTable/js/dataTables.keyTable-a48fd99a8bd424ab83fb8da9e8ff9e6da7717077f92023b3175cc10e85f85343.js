!function(e,t,s){var i=function(i,n){"use strict";var a=function(e,t){if(!n.versionCheck||!n.versionCheck("1.10.8"))throw"KeyTable requires DataTables 1.10.8 or newer";this.c=i.extend(!0,{},n.defaults.keyTable,a.defaults,t),this.s={dt:new n.Api(e),enable:!0},this.dom={};var s=this.s.dt.settings()[0],l=s.keytable;return l?l:(s.keytable=this,void this._constructor())};return a.prototype={blur:function(){this._blur()},enable:function(e){this.s.enable=e},focus:function(e,t){this._focus(this.s.dt.cell(e,t))},_constructor:function(){this._tabInput();var e=this,s=this.s.dt,n=i(s.table().node());"static"===n.css("position")&&n.css("position","relative"),i(s.table().body()).on("click.keyTable","th, td",function(){if(e.s.enable!==!1){var t=s.cell(this);t.any()&&e._focus(t)}}),i(t.body).on("keydown.keyTable",function(t){e._key(t)}),this.c.blurable&&i(t.body).on("click.keyTable",function(t){i(t.target).parents(".dataTables_filter").length&&e._blur(),i(t.target).parents().filter(s.table().container()).length||i(t.target).parents("div.DTE").length||e._blur()}),this.c.editor&&s.on("key.kt",function(t,s,i,n,a){e._editor(i,a)}),s.settings()[0].oFeatures.bStateSave&&s.on("stateSaveParams.keyTable",function(t,s,i){i.keyTable=e.s.lastFocus?e.s.lastFocus.index():null}),s.on("destroy.keyTable",function(){s.off(".keyTable"),i(s.table().body()).off("click.keyTable","th, td"),i(t.body).off("keydown.keyTable").off("click.keyTable")});var a=s.state.loaded();a&&a.keyTable?s.cell(a.keyTable).focus():this.c.focus&&s.cell(this.c.focus).focus()},_blur:function(){if(this.s.enable&&this.s.lastFocus){var e=this.s.lastFocus;i(e.node()).removeClass(this.c.className),this.s.lastFocus=null,this._emitEvent("key-blur",[this.s.dt,e])}},_columns:function(){var e=this.s.dt,t=e.columns(this.c.columns).indexes(),s=[];return e.columns(":visible").every(function(e){-1!==t.indexOf(e)&&s.push(e)}),s},_editor:function(e,t){var s=this.s.dt,n=this.c.editor;t.stopPropagation(),n.inline(this.s.lastFocus.index());var a=i("div.DTE input");a.length&&a[0].select(),s.keys.enable("navigation-only"),s.one("key-blur.editor",function(){n.displayed()&&n.submit()}),n.one("close",function(){s.keys.enable(!0),s.off("key-blur.editor")})},_emitEvent:function(e,t){this.s.dt.iterator("table",function(s){i(s.nTable).triggerHandler(e,t)})},_focus:function(s,n){var a=this,l=this.s.dt,o=l.page.info(),r=this.s.lastFocus;if(this.s.enable){if("number"!=typeof s){var c=s.index();n=c.column,s=l.rows({filter:"applied",order:"applied"}).indexes().indexOf(c.row),o.serverSide&&(s+=o.start)}if(s<o.start||s>=o.start+o.length)return void l.one("draw",function(){a._focus(s,n)}).page(Math.floor(s/o.length)).draw(!1);if(-1!==i.inArray(n,this._columns())){o.serverSide&&(s-=o.start);var u=l.cell(":eq("+s+")",n);if(r){if(r.node()===u.node())return;this._blur()}var f=i(u.node());f.addClass(this.c.className),this._scroll(i(e),i(t.body),f,"offset");var d=l.table().body().parentNode;if(d!==l.table().header().parentNode){var h=i(d.parentNode);this._scroll(h,h,f,"position")}this.s.lastFocus=u,this._emitEvent("key-focus",[this.s.dt,u]),l.state.save()}}},_key:function(e){if(this.s.enable&&!(0===e.keyCode||e.ctrlKey||e.metaKey||e.altKey)){var t=this.s.lastFocus;if(t){var s=this,n=this.s.dt;if(!this.c.keys||-1!==i.inArray(e.keyCode,this.c.keys))switch(e.keyCode){case 9:this._shift(e,e.shiftKey?"left":"right",!0);break;case 27:this.s.blurable&&this.s.enable===!0&&this._blur();break;case 33:case 34:e.preventDefault();var a=n.cells({page:"current"}).nodes().indexOf(t.node());n.one("draw",function(){var e=n.cells({page:"current"}).nodes();s._focus(n.cell(a<e.length?e[a]:e[e.length-1]))}).page(33===e.keyCode?"previous":"next").draw(!1);break;case 35:case 36:e.preventDefault();var l=n.cells({page:"current"}).indexes();this._focus(n.cell(l[35===e.keyCode?l.length-1:0]));break;case 37:this._shift(e,"left");break;case 38:this._shift(e,"up");break;case 39:this._shift(e,"right");break;case 40:this._shift(e,"down");break;default:this.s.enable===!0&&this._emitEvent("key",[n,e.keyCode,this.s.lastFocus,e])}}}},_scroll:function(e,t,s,i){var n=s[i](),a=s.outerHeight(),l=s.outerWidth(),o=t.scrollTop(),r=t.scrollLeft(),c=e.height(),u=e.width();n.top<o&&t.scrollTop(n.top),n.left<r&&t.scrollLeft(n.left),n.top+a>o+c&&t.scrollTop(n.top+a-c),n.left+l>r+u&&t.scrollLeft(n.left+l-u)},_shift:function(e,t,s){var i=this.s.dt,n=i.page.info(),a=n.recordsDisplay,l=this.s.lastFocus,o=this._columns();if(l){var r=i.rows({filter:"applied",order:"applied"}).indexes().indexOf(l.index().row);n.serverSide&&(r+=n.start);var c=i.columns(o).indexes().indexOf(l.index().column),u=r,f=o[c];"right"===t?c>=o.length-1?(u++,f=o[0]):f=o[c+1]:"left"===t?0===c?(u--,f=o[o.length-1]):f=o[c-1]:"up"===t?u--:"down"===t&&u++,u>=0&&a>u&&f>=0&&f<=o.length?(e.preventDefault(),this._focus(u,f)):s&&this.c.blurable?this._blur():e.preventDefault()}},_tabInput:function(){var e=this,t=this.s.dt,s=null!==this.c.tabIndex?this.c.tabIndex:t.settings()[0].iTabIndex;if(-1!=s){var n=i('<div><input type="text" tabindex="'+s+'"/></div>').css({position:"absolute",height:1,width:0,overflow:"hidden"}).insertBefore(t.table().node());n.children().on("focus",function(){e._focus(t.cell(":eq(0)",{page:"current"}))})}}},a.defaults={blurable:!0,className:"focus",columns:"",editor:null,focus:null,keys:null,tabIndex:null},a.version="2.0.0",i.fn.dataTable.KeyTable=a,i.fn.DataTable.KeyTable=a,n.Api.register("cell.blur()",function(){return this.iterator("table",function(e){e.keytable&&e.keytable.blur()})}),n.Api.register("cell().focus()",function(){return this.iterator("cell",function(e,t,s){e.keytable&&e.keytable.focus(t,s)})}),n.Api.register("keys.disable()",function(){return this.iterator("table",function(e){e.keytable&&e.keytable.enable(!1)})}),n.Api.register("keys.enable()",function(e){return this.iterator("table",function(t){t.keytable&&t.keytable.enable(e===s?!0:e)})}),i(t).on("preInit.dt.dtk",function(e,t){if("dt"===e.namespace){var s=t.oInit.keys,l=n.defaults.keys;if(s||l){var o=i.extend({},s,l);s!==!1&&new a(t,o)}}}),a};"function"==typeof define&&define.amd?define(["jquery","datatables"],i):"object"==typeof exports?i(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.KeyTable&&i(jQuery,jQuery.fn.dataTable)}(window,document);