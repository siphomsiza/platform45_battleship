!function(T){T.PeriodicalUpdater=function(o,t,a){function e(o){var e=jQuery.extend(!0,{},g);"function"==typeof t.data&&(e.data=t.data()),e.data&&"number"==typeof e.data&&(e.data=e.data.toString()),o||0===s?(n("Sending data"),T(function(){T.ajax(e)})):0<s&&d<s?(n("Sending data because we are at "+d+" of "+s+" calls"),T(function(){T.ajax(e)}),d++):n(-1==s?"NOT sending data: stop has been called":"NOT sending data: maximum number of calls reached - "+s,1)}t||(t={});var i=jQuery.extend(!0,{url:o,cache:!1,method:"GET",data:"",minTimeout:1e3,maxTimeout:64e3,multiplier:2,maxCalls:0,autoStop:0,autoStopCallback:null,cookie:!1,runatonce:!1,verbose:0},t),n=function(o,e){if(e=e||1,i.verbose>=e)try{console.log(o)}catch(t){}},c=null,r=null,u=null,l=i.minTimeout,s=i.maxCalls,m=i.autoStop,d=0,f=0,k=s,p=function(o){T(function(){null!==c&&clearTimeout(c),n("resetting timer to "+(l=o)+".",2),i.cookie&&T.cookie&&T.cookie(i.cookie.name,l,i.cookie),c=setTimeout(e,l)})},y=function(){if(1<i.multiplier){var o=l;(l*=i.multiplier)>i.maxTimeout&&(l=i.maxTimeout),n("adjusting timer from "+o+" to "+l+".",2)}p(l)};i.cookie&&("boolean"==typeof i.cookie?i.cookie={name:o}:"object"!=typeof i.cookie&&(i.cookie={name:i.cookie.toString()}),i.cookie.name||(i.cookie.name=o),T.cookie?T.cookie(i.cookie.name)&&p(T.cookie(i.cookie.name)):T.getScript("https://raw.github.com/carhartl/jquery-cookie/master/jquery.cookie.js",function(){n("Loaded the cookies handler script",2),T.cookie(i.cookie.name)?(n("Not runatonce and have cookie value",2),p(T.cookie(i.cookie.name))):(n("Not runatonce, but no cookie value",2),p(l))}).fail(function(){n("Could not load the cookies handler script",1),p(l)}));var g=jQuery.extend(!0,{},i);i.type&&!g.dataType&&(g.dataType=i.type),i.sendData&&(g.data=i.sendData),g.type=i.method,g.ifModified=!0;var b={boostTimer:function(o){0<o&&1!=o?(n("Boosting timer by a factor of "+o),l*=o):n("Cannot boost timer by a factor of "+o),p(l)},restart:function(o){n("Calling restart"),s=k,f=d=0,p(o||l)},send:function(){n("Explicit call to send"),e(!0)},stop:function(){n("Calling stop"),s=-1,i.cookie&&T.cookie&&T.cookie(i.cookie.name,null,i.cookie)}};return g.success=function(o){n("Successful run! (In 'success')",2),r=o},g.complete=function(o,e){if(n("Status of call: "+e+" (In 'complete')",2),"success"==e||"notmodified"==e){var t=T.trim(o.responseText);if(u==t){if(0<m&&++f==m)return b.stop(),void(i.autoStopCallback&&i.autoStopCallback(f));y()}else f=0,p(i.minTimeout),u=t,i.cookie&&T.cookie(i.cookie.name,u,i.cookie),null===r&&(r=t),"json"===g.dataType&&"string"==typeof r&&"success"==e&&(r=JSON.parse(r)),i.success&&i.success(r,e,o,b),a&&a(r,e,o,b)}i.complete&&i.complete(o,e),r=null},g.error=function(o,e){n("Error message: "+e+" (In 'error')",2),"notmodified"!=e&&(u=null,i.cookie&&T.cookie(i.cookie.name,null,i.cookie),p(i.minTimeout)),i.error&&i.error(o,e)},i.runatonce?(n("Executing a call immediately",1),e(!0)):T.cookie&&T.cookie(i.cookie.name)||(n("Enqueing a the call for after "+l,1),p(l)),b},T.fn.PeriodicalUpdater=function(o,e,t){var a=this;return T.PeriodicalUpdater(o,e,function(){return t.apply(a,arguments)})}}(jQuery);